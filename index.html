<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Subresource Integrity</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <meta content="Bikeshed version 618007319, updated Thu Jun 26 17:23:55 2025 -0700" name="generator">
  <link href="http://www.w3.org/TR/SRI/" rel="canonical">
  <meta content="b6014427d13ec544dc58d936ff6cd538d9370767" name="revision">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-idl-highlighting */
pre.idl.highlight {
    background: var(--borderedblock-bg, var(--def-bg));
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-wpt */
:root {
    --wpt-border: hsl(0, 0%, 60%);
    --wpt-bg: hsl(0, 0%, 95%);
    --wpt-text: var(--text);
    --wptheading-text: hsl(0, 0%, 30%);
}
@media (prefers-color-scheme: dark) {
    :root {
        --wpt-border: hsl(0, 0%, 30%);
        --wpt-bg: var(--borderedblock-bg);
        --wpt-text: var(--text);
        --wptheading-text: hsl(0, 0%, 60%);
    }
}
.wpt-tests-block {
    list-style: none;
    border-left: .5em solid var(--wpt-border);
    background: var(--wpt-bg);
    color: var(--wpt-text);
    margin: 1em auto;
    padding: .5em;
}
.wpt-tests-block summary {
    color: var(--wptheading-text);
    font-weight: normal;
    text-transform: uppercase;
}
.wpt-tests-block summary::marker{
    color: var(--wpt-border);
}
.wpt-tests-block summary:hover::marker{
    color: var(--wpt-text);
}
/*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
.wpt-tests-block:not([open]){
    padding: 0;
    border: none;
    background: none;
    font-size: 0.75em;
    line-height: 1;
    position: relative;
    margin: 1em 0 0;
}
.wpt-tests-block:not([open]) summary {
    position: absolute;
    right: 0;
    bottom: 0;
}
/*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
.wpt-tests-block:not([open]):last-child {
    padding-bottom: 1px;
    margin-bottom: -1px;
}
/*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
li:not(:last-child) > .wpt-tests-block:not([open]):last-child,
dd:not(:last-child) > .wpt-tests-block:not([open]):last-child {
    padding-bottom: 0;
    margin-bottom: 0;
}
.wpt-tests-block:not([open]):not(:hover){
    opacity: 0.5;
}
.wpt-tests-list {
    list-style: none;
    display: grid;
    margin: 0;
    padding: 0;
    grid-template-columns: 1fr max-content auto auto;
    grid-column-gap: .5em;
}
.wpt-tests-block hr:last-child {
    display: none;
}
.wpt-test {
    display: contents;
}
.wpt-test > a {
    text-decoration: underline;
    border: none;
}
.wpt-test > .wpt-name { grid-column: 1; }
.wpt-test > .wpt-results { grid-column: 2; }
.wpt-test > .wpt-live { grid-column: 3; }
.wpt-test > .wpt-source { grid-column: 4; }

.wpt-test > .wpt-results {
    display: flex;
    gap: .1em;
}
.wpt-test .wpt-result {
    display: inline-block;
    height: 1em;
    width: 1em;
    border-radius: 50%;
    position: relative;
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/">
    <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
</a>
</p>
   <h1 class="p-name no-ref" id="title">Subresource Integrity</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types/#ED">Editor’s Draft</a>,
    <time class="dt-updated" datetime="2025-07-06">6 July 2025</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://w3c.github.io/webappsec-subresource-integrity/">https://w3c.github.io/webappsec-subresource-integrity/</a>
      <dt>Latest published version:
      <dd><a href="http://www.w3.org/TR/SRI/">http://www.w3.org/TR/SRI/</a>
      <dt>Version History:
      <dd><a href="https://github.com/w3c/webappsec-subresource-integrity/commits/gh-pages">https://github.com/w3c/webappsec-subresource-integrity/commits/gh-pages</a>
      <dt>Feedback:
      <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5BSRI%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[SRI] <i data-lt>… message topic …</i></kbd>” (<a href="https://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
      <dd><a href="https://github.com/w3c/webappsec-subresource-integrity/issues/">GitHub</a>
      <dt class="editor">Editor:
      <dd class="editor p-author h-card vcard" data-editor-id="68466"><a class="p-name fn u-url url" href="https://frederik-braun.com">Frederik Braun</a> (<span class="p-org org">Mozilla</span>) <a class="u-email email" href="mailto:fbraun@mozilla.com">fbraun@mozilla.com</a>
      <dt class="editor">Former Editors:
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-url url" href="http://devd.me">Devdatta Akhawe</a> (<span class="p-org org">Dropbox Inc.</span>) <a class="u-email email" href="mailto:dev.akhawe@gmail.com">dev.akhawe@gmail.com</a>
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-url url" href="https://fmarier.org">François Marier</a> (<span class="p-org org">Mozilla</span>) <a class="u-email email" href="mailto:francois@mozilla.com">francois@mozilla.com</a>
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-url url" href="https://joelweinberger.us">Joel Weinberger</a> (<span class="p-org org">Google Inc.</span>) <a class="u-email email" href="mailto:jww@google.com">jww@google.com</a>
      <dt>Test Suite:
      <dd class="wpt-overview"><a href="https://wpt.fyi/results/subresource-integrity/">https://wpt.fyi/results/subresource-integrity/</a>
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2025 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply.
</p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification defines a mechanism by which user agents may verify that a
fetched resource has been delivered without unexpected manipulation.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p>
	This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress.

</p>
   <p>
  <strong>Changes to this document may be tracked at
  <a href="https://github.com/w3c/webappsec">https://github.com/w3c/webappsec</a>.</strong>

</p>
   <p>
	The (<a href="https://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list
	<a href="mailto:public-webappsec@w3.org?Subject=%5BSRI%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a>
	(see <a href="https://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “SRI” in the subject,
	preferably like this:
	“[SRI] <em>…summary of comment…</em>”

</p>
   <p>
	This document was produced by the
  <a href="https://www.w3.org/groups/wg/webappsec">Web Application Security Working Group</a>.

</p>
   <p>
	This document was produced by a group operating under
	the <a href="https://www.w3.org/policies/patent-policy/">W3C Patent Policy</a>.
	W3C maintains a <a href="https://www.w3.org/groups/wg/webappsec/ipr" rel="disclosure">public list of any patent disclosures</a>
	made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent that the individual believes contains <a href="https://www.w3.org/policies/patent-policy/#def-essential">Essential Claim(s)</a>
	must disclose the information in accordance with <a href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">section 6 of the W3C Patent Policy</a>.

</p>
   <p>
  This document is governed by the <a href="https://www.w3.org/policies/process/20231103/" id="w3c_process_revision">03 November 2023 W3C Process Document</a>.

</p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#goals"><span class="secno">1.1</span> <span class="content">Goals</span></a>
      <li>
       <a href="#examples"><span class="secno">1.2</span> <span class="content">Use Cases/Examples</span></a>
       <ol class="toc">
        <li><a href="#resource-integrity"><span class="secno">1.2.1</span> <span class="content">Resource Integrity</span></a>
       </ol>
     </ol>
    <li>
     <a href="#terms"><span class="secno">2</span> <span class="content">Key Concepts and Terminology</span></a>
     <ol class="toc">
      <li><a href="#grammar-concepts"><span class="secno">2.1</span> <span class="content">Grammatical Concepts</span></a>
     </ol>
    <li>
     <a href="#framework"><span class="secno">3</span> <span class="content">Framework</span></a>
     <ol class="toc">
      <li><a href="#integrity-metadata-description"><span class="secno">3.1</span> <span class="content">Integrity metadata</span></a>
      <li>
       <a href="#hash-functions"><span class="secno">3.2</span> <span class="content">Cryptographic hash functions</span></a>
       <ol class="toc">
        <li><a href="#agility"><span class="secno">3.2.1</span> <span class="content">Agility</span></a>
        <li><a href="#priority"><span class="secno">3.2.2</span> <span class="content">Priority</span></a>
       </ol>
      <li>
       <a href="#verification-algorithms"><span class="secno">3.3</span> <span class="content">Response verification algorithms</span></a>
       <ol class="toc">
        <li><a href="#apply-algorithm-to-response"><span class="secno">3.3.1</span> <span class="content">Apply <var>algorithm</var> to <var>bytes</var></span></a>
        <li><a href="#parse-metadata-section"><span class="secno">3.3.2</span> <span class="content">Parse metadata</span></a>
        <li><a href="#get-the-strongest-metadata"><span class="secno">3.3.3</span> <span class="content">Get the strongest metadata from <var>set</var></span></a>
        <li><a href="#does-response-match-metadatalist"><span class="secno">3.3.4</span> <span class="content">Do <var>bytes</var> match <var>metadataList</var>?</span></a>
       </ol>
      <li><a href="#verification-of-html-document-subresources"><span class="secno">3.4</span> <span class="content">Verification of HTML document subresources</span></a>
      <li><a href="#the-integrity-attribute"><span class="secno">3.5</span> <span class="content">The <code>integrity</code> attribute</span></a>
      <li><a href="#the-integrity-link-processing-option"><span class="secno">3.6</span> <span class="content">The <code>integrity</code> link processing option</span></a>
      <li><a href="#handling-integrity-violations"><span class="secno">3.7</span> <span class="content">Handling integrity violations</span></a>
      <li>
       <a href="#integrity-policy-section"><span class="secno">3.8</span> <span class="content">Integrity-Policy</span></a>
       <ol class="toc">
        <li><a href="#parse-integrity-policy-headers-section"><span class="secno">3.8.1</span> <span class="content">Parse Integrity-Policy headers</span></a>
        <li><a href="#should-request-be-blocked-by-integrity-policy-section"><span class="secno">3.8.2</span> <span class="content">Should request be blocked by Integrity Policy</span></a>
        <li><a href="#report-violations"><span class="secno">3.8.3</span> <span class="content">Report violations</span></a>
       </ol>
     </ol>
    <li><a href="#proxies"><span class="secno">4</span> <span class="content">Proxies</span></a>
    <li>
     <a href="#security-considerations"><span class="secno">5</span> <span class="content">Security and Privacy Considerations</span></a>
     <ol class="toc">
      <li><a href="#non-secure-contexts"><span class="secno">5.1</span> <span class="content">Non-secure contexts remain non-secure</span></a>
      <li><a href="#hash-collision-attacks"><span class="secno">5.2</span> <span class="content">Hash collision attacks</span></a>
      <li><a href="#cross-origin-data-leakage"><span class="secno">5.3</span> <span class="content">Cross-origin data leakage</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">6</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p>Sites and applications on the web are rarely composed of resources from
  only a single origin. For example, authors pull scripts and styles from a
  wide variety of services and content delivery networks, and must trust
  that the delivered representation is, in fact, what they expected to
  load. If an attacker can trick a user into downloading content from
  a hostile server (via DNS <a data-link-type="biblio" href="#biblio-rfc1035" title="Domain names - implementation and specification">[RFC1035]</a> poisoning, or other such means), the author has
  no recourse. Likewise, an attacker who can replace the file on the Content
  Delivery Network (CDN) server has the ability to inject arbitrary content.</p>
   <p>Delivering resources over a secure channel mitigates some of this risk: with
  TLS <a data-link-type="biblio" href="#biblio-tls" title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</a>, HSTS <a data-link-type="biblio" href="#biblio-rfc6797" title="HTTP Strict Transport Security (HSTS)">[RFC6797]</a>, and pinned public keys
  <a data-link-type="biblio" href="#biblio-rfc7469" title="Public Key Pinning Extension for HTTP">[RFC7469]</a>, a user agent can be fairly certain
  that it is indeed speaking with the server it believes it’s talking to. These
  mechanisms, however, authenticate <em>only</em> the server, <em>not</em> the content. An
  attacker (or administrator) with access to the server can manipulate content with
  impunity. Ideally, authors would not only be able to pin the keys of a
  server, but also pin the <em>content</em>, ensuring that an exact representation of
  a resource, and <em>only</em> that representation, loads and executes.</p>
   <p>This document specifies such a validation scheme, extending two HTML elements
  with an <code>integrity</code> attribute that contains a cryptographic hash
  of the representation of the resource the author expects to load. For instance,
  an author may wish to load some framework from a shared server rather than hosting it
  on their own origin. Specifying that the <em>expected</em> SHA-384 hash of
  <code>https://example.com/example-framework.js</code>
  is <code>Li9vy3DqF8tnTXuiaAJuML3ky+er10rcgNR/VqsVpcw+ThHmYcwiB1pbOxEbzJr7</code> means
  that the user agent can verify that the data it loads from that URL matches
  that expected hash before executing the JavaScript it contains. This
  integrity verification significantly reduces the risk that an attacker can
  substitute malicious content.</p>
   <p>This example can be communicated to a user agent by adding the hash to a
  <code>script</code> element, like so:</p>
   <div class="example" id="example-59806504">
    <a class="self-link" href="#example-59806504"></a>
  
<pre class="highlight"><c- p>&lt;</c-><c- f>script</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.com/example-framework.js"</c->
        <c- e>integrity</c-><c- o>=</c-><c- s>"sha384-Li9vy3DqF8tnTXuiaAJuML3ky+er10rcgNR/VqsVpcw+ThHmYcwiB1pbOxEbzJr7"</c->
        <c- e>crossorigin</c-><c- o>=</c-><c- s>"anonymous"</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
   </div>
   <p>Scripts, of course, are not the only response type which would benefit
  from integrity validation. The scheme specified here also applies to <code>link</code>
  and future versions of this specification are likely to expand this coverage.</p>
   <details class="wpt-tests-block" dir="ltr" lang="en">
    <summary>Tests</summary>
    <ul class="wpt-tests-list">
     <li class="wpt-test"><a class="wpt-name" href="https://wpt.fyi/results/subresource-integrity/subresource-integrity.html" title="subresource-integrity/subresource-integrity.html">subresource-integrity.html</a> <a class="wpt-live" href="http://wpt.live/subresource-integrity/subresource-integrity.html"><small>(live test)</small></a> <a class="wpt-source" href="https://github.com/web-platform-tests/wpt/blob/master/subresource-integrity/subresource-integrity.html"><small>(source)</small></a>
    </ul>
   </details>
   <h3 class="heading settled" data-level="1.1" id="goals"><span class="secno">1.1. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>
   <ol>
    <li data-md>
     <p>Compromise of a third-party service should not automatically mean
  compromise of every site which includes its scripts. Content authors
  will have a mechanism by which they can specify expectations for
  content they load, meaning for example that they could load a
  <em>specific</em> script, and not <em>any</em> script that happens to have a
  particular URL.</p>
    <li data-md>
     <p>The verification mechanism should have error-reporting functionality which
  would inform the author that an invalid response was received.</p>
   </ol>
   <h3 class="heading settled" data-level="1.2" id="examples"><span class="secno">1.2. </span><span class="content">Use Cases/Examples</span><a class="self-link" href="#examples"></a></h3>
   <h4 class="heading settled" data-level="1.2.1" id="resource-integrity"><span class="secno">1.2.1. </span><span class="content">Resource Integrity</span><a class="self-link" href="#resource-integrity"></a></h4>
   <ul>
    <li data-md>
     <p>An author wishes to use a content delivery network to improve performance
  for globally-distributed users. It is important, however, to ensure that
  the CDN’s servers deliver <em>only</em> the code the author expects them to
  deliver. To mitigate the risk that a CDN compromise (or unexpectedly malicious
  behavior) would change that site in unfortunate ways, the following
  <a data-link-type="dfn" href="#integrity-metadata" id="ref-for-integrity-metadata">integrity metadata</a> is added to the <code>link</code> element included on the page:</p>
     <div class="example" id="example-ed55c3e6">
      <a class="self-link" href="#example-ed55c3e6"></a>
  
<pre class="highlight"><c- p>&lt;</c-><c- f>link</c-> <c- e>rel</c-><c- o>=</c-><c- s>"stylesheet"</c-> <c- e>href</c-><c- o>=</c-><c- s>"https://site53.example.net/style.css"</c->
      <c- e>integrity</c-><c- o>=</c-><c- s>"sha384-+/M6kredJcxdsqkczBUjMLvqyHb1K/JThDXWsBVxMEeZHEaMKEOEct339VItX1zB"</c->
      <c- e>crossorigin</c-><c- o>=</c-><c- s>"anonymous"</c-><c- p>></c->
</pre>
     </div>
    <li data-md>
     <p>An author wants to include JavaScript provided by a third-party
  analytics service. To ensure that only the code that has been carefully
  reviewed is executed, the author generates <a data-link-type="dfn" href="#integrity-metadata" id="ref-for-integrity-metadata①">integrity metadata</a> for
  the script, and adds it to the <code>script</code> element:</p>
     <div class="example" id="example-af0f59ce">
      <a class="self-link" href="#example-af0f59ce"></a>
  
<pre class="highlight"><c- p>&lt;</c-><c- f>script</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://analytics-r-us.example.com/v1.0/include.js"</c->
        <c- e>integrity</c-><c- o>=</c-><c- s>"sha384-MBO5IDfYaE6c6Aao94oZrIOiC6CGiSN2n4QUbHNPhzk5Xhm0djZLQqTpL0HzTUxk"</c->
        <c- e>crossorigin</c-><c- o>=</c-><c- s>"anonymous"</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
     </div>
    <li data-md>
     <p>A user agent wishes to ensure that JavaScript code running in high-privilege HTML
  contexts (for example, a browser’s New Tab page) aren’t manipulated before display.
  <a data-link-type="dfn" href="#integrity-metadata" id="ref-for-integrity-metadata②">Integrity metadata</a> mitigates the risk that altered JavaScript will run
  in these pages' high-privilege contexts.</p>
   </ul>
   <h2 class="heading settled" data-level="2" id="terms"><span class="secno">2. </span><span class="content">Key Concepts and Terminology</span><a class="self-link" href="#terms"></a></h2>
   <p>This section defines several terms used throughout the document.</p>
   <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="digest">digest</dfn> refers to the base64 encoded result of
  executing a cryptographic hash function on an arbitrary block of data.</p>
   <p>The terms <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin">origin</a> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin" id="ref-for-same-origin">same origin</a> are defined in HTML. <a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a></p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="base64-encoding">base64 encoding</dfn> is defined in <a href="https://tools.ietf.org/html/rfc4648#section-4">Section 4 of RFC 4648</a>.
  <a data-link-type="biblio" href="#biblio-rfc4648" title="The Base16, Base32, and Base64 Data Encodings">[RFC4648]</a></p>
   <p>The <a data-link-type="dfn" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something">SHA-256</a>, <a data-link-type="dfn" data-refhint-key="37de769a" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something①">SHA-384</a>, and <a data-link-type="dfn" data-refhint-key="a801f883" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something②">SHA-512</a> are part
  of the <a data-link-type="dfn" data-refhint-key="14c46ca8" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something③">SHA-2</a> set of cryptographic hash functions defined by the
  NIST. <a data-link-type="biblio" href="#biblio-sha2" title="FIPS PUB 180-4, Secure Hash Standard">[SHA2]</a></p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="valid-sri-hash-algorithm-token-set">valid SRI hash algorithm token set</dfn> is the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">ordered set</a>
  « "<code>sha256</code>", "<code>sha384</code>", "<code>sha512</code>" » (corresponding to <a data-link-type="dfn" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something④">SHA-256</a>,
  <a data-link-type="dfn" data-refhint-key="37de769a" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something⑤">SHA-384</a>, and <a data-link-type="dfn" data-refhint-key="a801f883" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something⑥">SHA-512</a> respectively). The ordering of this set is
  meaningful, with stronger algorithms appearing later in the set. See
  <a href="#priority">§ 3.2.2 Priority</a> and <a href="#get-the-strongest-metadata">§ 3.3.3 Get the strongest metadata from set</a> for
  additional information.</p>
   <p>A string is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="valid-sri-hash-algorithm-token">valid SRI hash algorithm token</dfn> if its
  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-lowercase" id="ref-for-ascii-lowercase">ASCII lowercase</a> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">contained</a> in the
  <a data-link-type="dfn" href="#valid-sri-hash-algorithm-token-set" id="ref-for-valid-sri-hash-algorithm-token-set">valid SRI hash algorithm token set</a>.</p>
   <h3 class="heading settled" data-level="2.1" id="grammar-concepts"><span class="secno">2.1. </span><span class="content">Grammatical Concepts</span><a class="self-link" href="#grammar-concepts"></a></h3>
   <p>The Augmented Backus-Naur Form (ABNF) notation used in this document is
  specified in RFC5234. <a data-link-type="biblio" href="#biblio-abnf" title="Augmented BNF for Syntax Specifications: ABNF">[ABNF]</a></p>
   <p><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="58fa9b5f0">Appendix B.1</a> of
  <a data-link-type="biblio" href="#biblio-abnf" title="Augmented BNF for Syntax Specifications: ABNF">[ABNF]</a> defines the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1">VCHAR</a> (printing characters) and <a data-link-type="dfn" data-refhint-key="fc7b3d90" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1①">WSP</a>
  (whitespace) rules.</p>
   <p>Content Security Policy defines the <a data-link-type="grammar" href="https://w3c.github.io/webappsec-csp/#grammardef-base64-value" id="ref-for-grammardef-base64-value"><code>base64-value</code></a> and
  <a data-link-type="grammar" href="https://w3c.github.io/webappsec-csp/#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm"><code>hash-algorithm</code></a> rules. <a data-link-type="biblio" href="#biblio-csp" title="Content Security Policy Level 3">[CSP]</a></p>
   <h2 class="heading settled" data-level="3" id="framework"><span class="secno">3. </span><span class="content">Framework</span><a class="self-link" href="#framework"></a></h2>
   <p>The integrity verification mechanism specified here boils down to the
  process of generating a sufficiently strong cryptographic digest for a
  resource, and transmitting that digest to a user agent so that it may be
  used to verify the response.</p>
   <h3 class="heading settled" data-level="3.1" id="integrity-metadata-description"><span class="secno">3.1. </span><span class="content">Integrity metadata</span><a class="self-link" href="#integrity-metadata-description"></a></h3>
   <p>To verify the integrity of a response, a user agent requires <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="integrity metadata" data-noexport id="integrity-metadata">integrity
  metadata</dfn> as part of the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">request</a>. This metadata consists of
  the following pieces of information:</p>
   <ul>
    <li data-md>
     <p>cryptographic hash function ("alg")</p>
    <li data-md>
     <p><a data-link-type="dfn" href="#digest" id="ref-for-digest">digest</a> ("val")</p>
    <li data-md>
     <p>options ("opt")</p>
   </ul>
   <p>The hash function and digest MUST be provided in order to validate a
  response’s integrity.</p>
   <p class="note" role="note"><span class="marker">Note:</span> At the moment, no options are defined. However, future versions of
  the spec may define options, such as MIME types <a data-link-type="biblio" href="#biblio-mime-types" title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">[MIME-TYPES]</a>.</p>
   <p>This metadata MUST be encoded in the same format as the <code>hash-source</code> (without
  the single quotes) in <a href="http://www.w3.org/TR/CSP2/#source-list-syntax">section 4.2 of the Content
  Security Policy Level 2 specification</a>.</p>
   <p>For example, given a script resource containing only the string <code>alert('Hello,   world.');</code>, an author might choose <a data-link-type="dfn" data-refhint-key="37de769a" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something⑦">SHA-384</a> as a hash function.
  <code>H8BRh8j48O9oYatfu5AZzq6A9RINhZO5H16dQZngK7T62em8MUt1FLm52t+eX6xO</code> is the <a data-link-type="dfn" href="#base64-encoding" id="ref-for-base64-encoding">base64 encoded</a> digest that results. This can be encoded
  as follows:</p>
   <div class="example" id="example-cc8e7f02">
    <a class="self-link" href="#example-cc8e7f02"></a>
  
<pre>sha384-H8BRh8j48O9oYatfu5AZzq6A9RINhZO5H16dQZngK7T62em8MUt1FLm52t+eX6xO
</pre>
   </div>
   <div class="note" role="note">
    
  Digests may be generated using any number of utilities. <a href="https://www.openssl.org/">OpenSSL</a>, for example, is quite commonly
  available. The example in this section is the result of the following command
  line:

  
<pre class="highlight">echo -n <c- u>"alert('Hello, world.');"</c-> <c- p>|</c-> openssl dgst -sha384 -binary <c- p>|</c-> openssl base64 -A
</pre>
   </div>
   <h3 class="heading settled" data-level="3.2" id="hash-functions"><span class="secno">3.2. </span><span class="content">Cryptographic hash functions</span><a class="self-link" href="#hash-functions"></a></h3>
   <p>Conformant user agents MUST support the <a data-link-type="dfn" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something⑧">SHA-256</a>, <a data-link-type="dfn" data-refhint-key="37de769a" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something⑨">SHA-384</a>,
  and <a data-link-type="dfn" data-refhint-key="a801f883" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something①⓪">SHA-512</a> cryptographic hash functions for use as part of a
  request’s <a data-link-type="dfn" href="#integrity-metadata" id="ref-for-integrity-metadata③">integrity metadata</a> and MAY support additional hash functions
  defined in future iterations of this document.</p>
   <p class="note" role="note"><span class="marker">NOTE:</span> The algorithms supported in this document are (currently!) believed to be
  resistent to second-preimage and collision attacks. Future additions/removals
  from the set of supported algorithms would be well-advised to apply similar
  standard. See <a href="#hash-collision-attacks">§ 5.2 Hash collision attacks</a>.</p>
   <h4 class="heading settled" data-level="3.2.1" id="agility"><span class="secno">3.2.1. </span><span class="content">Agility</span><a class="self-link" href="#agility"></a></h4>
   <p>Multiple sets of <a data-link-type="dfn" href="#integrity-metadata" id="ref-for-integrity-metadata④">integrity metadata</a> may be associated with a single
  resource in order to provide agility in the face of future cryptographic discoveries.
  For example, the resource described in the previous section may be described
  by either of the following hash expressions:</p>
   <div class="example" id="example-a9403be4">
    <a class="self-link" href="#example-a9403be4"></a>
  
<pre>sha384-H8BRh8j48O9oYatfu5AZzq6A9RINhZO5H16dQZngK7T62em8MUt1FLm52t+eX6xO
sha512-Q2bFTOhEALkN8hOms2FKTDLy7eugP2zFZ1T8LCvX42Fp3WoNr3bjZSAHeOsHrbV1Fu9/A0EzCinRE7Af1ofPrw==
</pre>
   </div>
   <p>Authors may choose to specify both, for example:</p>
   <div class="example" id="example-da4338e9">
    <a class="self-link" href="#example-da4338e9"></a>
  
<pre class="highlight"><c- p>&lt;</c-><c- f>script</c-> <c- e>src</c-><c- o>=</c-><c- s>"hello_world.js"</c->
   <c- e>integrity</c-><c- o>=</c-><c- s>"sha384-H8BRh8j48O9oYatfu5AZzq6A9RINhZO5H16dQZngK7T62em8MUt1FLm52t+eX6xO</c->
<c- s>              sha512-Q2bFTOhEALkN8hOms2FKTDLy7eugP2zFZ1T8LCvX42Fp3WoNr3bjZSAHeOsHrbV1Fu9/A0EzCinRE7Af1ofPrw=="</c->
   <c- e>crossorigin</c-><c- o>=</c-><c- s>"anonymous"</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
   </div>
   <p>In this case, the user agent will choose the strongest hash function in the
  list, and use that metadata to validate the response (as described below in
  the <a href="#parse-metadata-section">§ 3.3.2 Parse metadata</a> and <a href="#get-the-strongest-metadata">§ 3.3.3 Get the strongest metadata from set</a> algorithms).</p>
   <p>When a hash function is determined to be insecure, user agents SHOULD deprecate
  and eventually remove support for integrity validation using the insecure hash
  function. User agents MAY check the validity of responses using a digest based on
  a deprecated function.</p>
   <p>To allow authors to switch to stronger hash functions without being held back by older
  user agents, validation using unsupported hash functions acts like no integrity value
  was provided (see the <a href="#does-response-match-metadatalist" id="ref-for-does-response-match-metadatalist">§ 3.3.4 Do bytes match metadataList?</a> algorithm below).
  Authors  are encouraged to use strong hash functions, and to begin migrating to
  stronger hash functions as they become available.</p>
   <h4 class="heading settled" data-level="3.2.2" id="priority"><span class="secno">3.2.2. </span><span class="content">Priority</span><a class="self-link" href="#priority"></a></h4>
   <p>The prioritization of hash algorithms is specified via the ordering of their
  respective tokens in the <a data-link-type="dfn" href="#valid-sri-hash-algorithm-token-set" id="ref-for-valid-sri-hash-algorithm-token-set①">valid SRI hash algorithm token set</a>. Algorithms
  appearing earlier in that set are weaker than algorithms appearing later in
  that set.</p>
   <p>As currently specified, <a data-link-type="dfn" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something①①">SHA-256</a> is weaker than <a data-link-type="dfn" data-refhint-key="37de769a" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something①②">SHA-384</a>, which is in
  turn weaker than <a data-link-type="dfn" data-refhint-key="a801f883" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something①③">SHA-512</a>. No other hashing algorithms are currently
  supported by this specification.</p>
   <h3 class="heading settled" data-level="3.3" id="verification-algorithms"><span class="secno">3.3. </span><span class="content">Response verification algorithms</span><a class="self-link" href="#verification-algorithms"></a></h3>
   <h4 class="heading settled" data-level="3.3.1" id="apply-algorithm-to-response"><span class="secno">3.3.1. </span><span class="content">Apply <var>algorithm</var> to <var>bytes</var></span><a class="self-link" href="#apply-algorithm-to-response"></a></h4>
   <ol>
    <li data-md>
     <p>Let <var>result</var> be the result of applying <var>algorithm</var> to <var>bytes</var>.</p>
    <li data-md>
     <p>Return the result of <a data-link-type="dfn" href="#base64-encoding" id="ref-for-base64-encoding①">base64 encoding</a> <var>result</var>.</p>
   </ol>
   <h4 class="heading settled" data-level="3.3.2" id="parse-metadata-section"><span class="secno">3.3.2. </span><span class="content">Parse metadata</span><a class="self-link" href="#parse-metadata-section"></a></h4>
   <p>When asked to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-metadata">parse metadata</dfn> given a string <var>metadata</var>, run the following steps:</p>
   <p class="note" role="note"><span class="marker">Note:</span> the algorithm returns a set of hash expressions whose hash functions are understood
  by the user agent.</p>
   <ol>
    <li data-md>
     <p>Let <var>result</var> be the empty set.</p>
    <li data-md>
     <p>For each <var>item</var> returned by <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#strictly-split" id="ref-for-strictly-split">splitting</a>
  <var>metadata</var> on spaces:</p>
     <ol>
      <li data-md>
       <p>Let <var>expression-and-options</var> be the result of
  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#strictly-split" id="ref-for-strictly-split①">splitting</a> <var>item</var> on U+003F (?).</p>
      <li data-md>
       <p>Let <var>algorithm-expression</var> be <var>expression-and-options</var>[0].</p>
      <li data-md>
       <p>Let <var>base64-value</var> be the empty string.</p>
      <li data-md>
       <p>Let <var>algorithm-and-value</var> be the result of
  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#strictly-split" id="ref-for-strictly-split②">splitting</a> <var>algorithm-expression</var> on U+002D (-).</p>
      <li data-md>
       <p>Let <var>algorithm</var> be <var>algorithm-and-value</var>[0].</p>
      <li data-md>
       <p>If <var>algorithm-and-value</var>[1] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain①">exists</a>, set
  <var>base64-value</var> to <var>algorithm-and-value</var>[1].</p>
      <li data-md>
       <p>If <var>algorithm</var> is not a <a data-link-type="dfn" href="#valid-sri-hash-algorithm-token" id="ref-for-valid-sri-hash-algorithm-token">valid SRI hash algorithm token</a>, then
  <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue">continue</a>.</p>
      <li data-md>
       <p>Let <var>metadata</var> be the ordered map  «["alg" → <var>algorithm</var>,
  "val" → <var>base64-value</var>]».</p>
       <p class="note" role="note"><span class="marker">Note:</span> Since no <code>options</code> are defined (see the
 <a href="#integrity-metadata-description">§ 3.1 Integrity metadata</a>), a corresponding entry is not set
 in <var>metadata</var>. If <code>options</code> are defined in a future version,
 <var>expression-and-options</var>[1] can be utilized as <code>options</code>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">Append</a> <var>metadata</var> to <var>result</var>.</p>
     </ol>
    <li data-md>
     <p>Return <var>result</var>.</p>
   </ol>
   <h4 class="heading settled" data-level="3.3.3" id="get-the-strongest-metadata"><span class="secno">3.3.3. </span><span class="content">Get the strongest metadata from <var>set</var></span><a class="self-link" href="#get-the-strongest-metadata"></a></h4>
   <ol>
    <li data-md>
     <p>Let <var>result</var> be the empty set and <var>strongest</var> be null.</p>
    <li data-md>
     <p>For each <var>item</var> in <var>set</var>:</p>
     <ol>
      <li data-md>
       <p class="assertion">Assert: <var>item</var>["<code>alg</code>"] is a <a data-link-type="dfn" href="#valid-sri-hash-algorithm-token" id="ref-for-valid-sri-hash-algorithm-token①">valid SRI hash algorithm token</a>.</p>
      <li data-md>
       <p>If <var>result</var> is the empty set, then:</p>
       <ol>
        <li data-md>
         <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append">Append</a> <var>item</var> to <var>result</var>.</p>
        <li data-md>
         <p>Set <var>strongest</var> to <var>item</var>.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue①">Continue</a>.</p>
       </ol>
      <li data-md>
       <p>Let <var>currentAlgorithm</var> be <var>strongest</var>["<code>alg</code>"], and <var>currentAlgorithmIndex</var>
  be the index of <var>currentAlgorithm</var> in the <a data-link-type="dfn" href="#valid-sri-hash-algorithm-token-set" id="ref-for-valid-sri-hash-algorithm-token-set②">valid SRI hash algorithm token set</a>.</p>
      <li data-md>
       <p>Let <var>newAlgorithm</var> be the <var>item</var>["<code>alg</code>"], and <var>newAlgorithmIndex</var>
  be the index of <var>newAlgorithm</var> in the <a data-link-type="dfn" href="#valid-sri-hash-algorithm-token-set" id="ref-for-valid-sri-hash-algorithm-token-set③">valid SRI hash algorithm token set</a>.</p>
      <li data-md>
       <p>If <var>newAlgorithmIndex</var> is less than <var>currentAlgorithmIndex</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue②">continue</a>.</p>
      <li data-md>
       <p>Otherwise, if <var>newAlgorithmIndex</var> is greater than <var>currentAlgorithmIndex</var>:</p>
       <ol>
        <li data-md>
         <p>Set <var>strongest</var> to <var>item</var>.</p>
        <li data-md>
         <p>Set <var>result</var> to « <var>item</var> ».</p>
       </ol>
      <li data-md>
       <p>Otherwise, <var>newAlgorithmIndex</var> and <var>currentAlgorithmIndex</var> are the
  same value. <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append①">Append</a> <var>item</var> to <var>result</var>.</p>
     </ol>
    <li data-md>
     <p>Return <var>result</var>.</p>
   </ol>
   <h4 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="3.3.4" data-lt="Do bytes match metadataList?" id="does-response-match-metadatalist"><span class="secno">3.3.4. </span><span class="content">Do <var>bytes</var> match <var>metadataList</var>?</span><a class="self-link" href="#does-response-match-metadatalist" id="ref-for-does-response-match-metadatalist①"></a></h4>
   <ol>
    <li data-md>
     <p>Let <var>parsedMetadata</var> be the result of
  <a data-link-type="dfn" href="#parse-metadata" id="ref-for-parse-metadata">parsing <var>metadataList</var></a>.</p>
    <li data-md>
     <p>If <var>parsedMetadata</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty">is empty</a> set, return <code>true</code>.</p>
    <li data-md>
     <p>Let <var>metadata</var> be the result of <a href="#get-the-strongest-metadata">
  getting the strongest metadata from <var>parsedMetadata</var></a>.</p>
    <li data-md>
     <p>For each <var>item</var> in <var>metadata</var>:</p>
     <ol>
      <li data-md>
       <p>Let <var>algorithm</var> be the <var>item</var>["alg"].</p>
      <li data-md>
       <p>Let <var>expectedValue</var> be the <var>item</var>["val"].</p>
      <li data-md>
       <p>Let <var>actualValue</var> be the result of <a href="#apply-algorithm-to-response">applying <var>algorithm</var> to <var>bytes</var>
  </a>.</p>
      <li data-md>
       <p>If <var>actualValue</var> is a case-sensitive match for
  <var>expectedValue</var>, return <code>true</code>.</p>
     </ol>
    <li data-md>
     <p>Return <code>false</code>.</p>
   </ol>
   <p>This algorithm allows the user agent to accept multiple, valid strong hash
  functions. For example, a developer might write a <code>script</code> element such as:</p>
   <div class="example" id="example-3e451647">
    <a class="self-link" href="#example-3e451647"></a>
  
<pre class="highlight"><c- p>&lt;</c-><c- f>script</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.com/example-framework.js"</c->
        <c- e>integrity</c-><c- o>=</c-><c- s>"sha384-Li9vy3DqF8tnTXuiaAJuML3ky+er10rcgNR/VqsVpcw+ThHmYcwiB1pbOxEbzJr7</c->
<c- s>                   sha384-+/M6kredJcxdsqkczBUjMLvqyHb1K/JThDXWsBVxMEeZHEaMKEOEct339VItX1zB"</c->
        <c- e>crossorigin</c-><c- o>=</c-><c- s>"anonymous"</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
   </div>
   <p>which would allow the user agent to accept two different content payloads, one
  of which matches the first <a data-link-type="dfn" data-refhint-key="37de769a" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something①④">SHA-384</a> hash value and the other matches the second
  <a data-link-type="dfn" data-refhint-key="37de769a" href="https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something①⑤">SHA-384</a> hash value.</p>
   <p class="note" role="note"><span class="marker">Note:</span> User agents may allow users to modify the result of this algorithm via
  user preferences, bookmarklets, third-party additions to the user agent, and
  other such mechanisms. For example, redirects generated by an extension like <a href="https://www.eff.org/https-everywhere">HTTPS Everywhere</a> could load and
  execute correctly, even if the HTTPS version of a resource differs from the HTTP
  version.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Subresource Integrity requires CORS and it is a logical error
  to attempt to use it without CORS. User agents are encouraged to report a
  warning message to the developer console to explain this failure. <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[Fetch]</a></p>
   <h3 class="heading settled" data-level="3.4" id="verification-of-html-document-subresources"><span class="secno">3.4. </span><span class="content">Verification of HTML document subresources</span><a class="self-link" href="#verification-of-html-document-subresources"></a></h3>
   <p>A variety of HTML elements result in requests for resources that are to be
  embedded into the document, or executed in its context. To support integrity
  metadata for some of these elements, a new <code>integrity</code> attribute is added to
  the list of content attributes for the <code>link</code> and <code>script</code> elements. <a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a></p>
   <p class="note" role="note"><span class="marker">Note:</span> A future revision of this specification is likely to include integrity support
  for all possible subresources, i.e., <code>a</code>, <code>audio</code>, <code>embed</code>, <code>iframe</code>, <code>img</code>,
  <code>link</code>, <code>object</code>, <code>script</code>, <code>source</code>, <code>track</code>, and <code>video</code> elements.</p>
   <h3 class="heading settled" data-level="3.5" id="the-integrity-attribute"><span class="secno">3.5. </span><span class="content">The <code>integrity</code> attribute</span><a class="self-link" href="#the-integrity-attribute"></a></h3>
   <p>The <code>integrity</code> attribute represents <a data-link-type="dfn" href="#integrity-metadata" id="ref-for-integrity-metadata⑤">integrity metadata</a> for an element.
  The value of the attribute MUST be either the empty string, or at least one
  valid metadata as described by the following ABNF grammar:</p>
<pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-integrity-metadata">integrity-metadata</dfn> = *<a data-link-type="grammar" data-refhint-key="fc7b3d90" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1②">WSP</a> <a data-link-type="grammar" href="#grammardef-hash-with-options" id="ref-for-grammardef-hash-with-options">hash-with-options</a> *(1*<a data-link-type="grammar" data-refhint-key="fc7b3d90" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1③">WSP</a> <a data-link-type="grammar" href="#grammardef-hash-with-options" id="ref-for-grammardef-hash-with-options①">hash-with-options</a> ) *<a data-link-type="grammar" data-refhint-key="fc7b3d90" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1④">WSP</a> / *<a data-link-type="grammar" data-refhint-key="fc7b3d90" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑤">WSP</a>
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-hash-with-options">hash-with-options</dfn>  = <a data-link-type="grammar" href="#grammardef-hash-expression" id="ref-for-grammardef-hash-expression">hash-expression</a> *("?" <a data-link-type="grammar" href="#grammardef-option-expression" id="ref-for-grammardef-option-expression">option-expression</a>)
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-option-expression">option-expression</dfn>  = *<a data-link-type="grammar" data-refhint-key="3fed24ef" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑥">VCHAR</a>
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-hash-expression">hash-expression</dfn>    = <a data-link-type="grammar" href="https://w3c.github.io/webappsec-csp/#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm①">hash-algorithm</a> "-" <a data-link-type="grammar" href="https://w3c.github.io/webappsec-csp/#grammardef-base64-value" id="ref-for-grammardef-base64-value①">base64-value</a>
</pre>
   <p><code>option-expression</code>s are associated on a per <code>hash-expression</code> basis and are
  applied only to the <code>hash-expression</code> that immediately precedes it.</p>
   <p>In order for user agents to remain fully forwards compatible with future
  options, the user agent MUST ignore all unrecognized  <code>option-expression</code>s.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Note that while the <code>option-expression</code> has been reserved in the syntax,
  no options have been defined. It is likely that a future version of the spec
  will define a more specific syntax for options, so it is defined here as broadly
  as possible.</p>
   <h3 class="heading settled" data-level="3.6" id="the-integrity-link-processing-option"><span class="secno">3.6. </span><span class="content">The <code>integrity</code> link processing option</span><a class="self-link" href="#the-integrity-link-processing-option"></a></h3>
   <p><a data-link-type="dfn" href="#integrity-metadata" id="ref-for-integrity-metadata⑥">Integrity metadata</a> can also be specified for `<code><a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#link" id="ref-for-link">link</a></code>` HTTP response headers
  as an <code>integrity</code> link parameter which MUST be specified using the same
  <a data-link-type="grammar" href="#grammardef-integrity-metadata" id="ref-for-grammardef-integrity-metadata"><code>integrity-metadata</code></a> grammar that applies to <code>integrity</code> attributes
  on elements. For example:</p>
<pre class="language-http highlight">Link: &lt;/style.css>; rel=preload; as=style;  crossorigin="anonymous"; integrity="sha256-[digest goes here]"
</pre>
   <h3 class="heading settled" data-level="3.7" id="handling-integrity-violations"><span class="secno">3.7. </span><span class="content">Handling integrity violations</span><a class="self-link" href="#handling-integrity-violations"></a></h3>
   <p>The user agent will refuse to render or execute responses that fail an integrity
  check, instead returning a network error as defined in Fetch <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[Fetch]</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> On a failed integrity check, an <code>error</code> event is fired. Developers
  wishing to provide a canonical fallback resource (e.g., a resource not served
  from a CDN, perhaps from a secondary, trusted, but slower source) can catch this
  <code>error</code> event and provide an appropriate handler to replace the
  failed resource with a different one.</p>
   <h3 class="heading settled" data-level="3.8" id="integrity-policy-section"><span class="secno">3.8. </span><span class="content">Integrity-Policy</span><a class="self-link" href="#integrity-policy-section"></a></h3>
   
  The <code>Integrity-Policy</code> and <code>Integrity-Policy-Report-Only</code> HTTP headers enable a document to
  enforce a policy regarding the integrity metadata requirements on all the subresources it
  loads of certain <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination">destinations</a>.


   <p>The headers' value is a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc9651#name-dictionaries" id="ref-for-name-dictionaries">Dictionary</a> <a data-link-type="biblio" href="#biblio-rfc9651" title="Structured Field Values for HTTP">[RFC9651]</a>, with every member-value being an
  <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc9651#name-inner-lists" id="ref-for-name-inner-lists">inner list</a> of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc9651#name-tokens" id="ref-for-name-tokens">tokens</a>.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="source">source</dfn> is a string. The only possible value for it is "<code>inline</code>".</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="destination">destination</dfn> is a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#destination-type" id="ref-for-destination-type">destination type</a>. The only possible value for it is "<code>script</code>".</p>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="integrity-policy">integrity policy</dfn>, is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">struct</a> that contains the following:</p>
   <ul>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="sources">sources</dfn>, a list of <a data-link-type="dfn" href="#source" id="ref-for-source">source</a>s, initially empty.</p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="blocked-destinations">blocked destinations</dfn>, a list of <a data-link-type="dfn" href="#destination" id="ref-for-destination">destination</a>s, initially empty.</p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="endpoints">endpoints</dfn>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a> of strings, initially empty.</p>
   </ul>
   <p>When <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="processing-an-integrity-policy">processing an integrity policy</dfn>, with a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list" id="ref-for-concept-header-list">header list</a> <var>headers</var>
  and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#header-name" id="ref-for-header-name">header name</a> <var>headerName</var>, do the following:</p>
   <ol>
    <li data-md>
     <p>Let <var>integrityPolicy</var> be a new <a data-link-type="dfn" href="#integrity-policy" id="ref-for-integrity-policy">integrity policy</a>.</p>
    <li data-md>
     <p>Let <var>dictionary</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header" id="ref-for-concept-header-list-get-structured-header">getting a structured field value</a> from <var>headers</var>
 given <var>headerName</var> and "<code>dictionary</code>".</p>
    <li data-md>
     <p>If <var>dictionary</var>["<code>sources</code>"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain②">exist</a> or if its value
 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain③">contains</a> "<code>inline</code>", <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append①">append</a> "<code>inline</code>" to
 <var>integrityPolicy</var>’s <a data-link-type="dfn" href="#sources" id="ref-for-sources">sources</a>.</p>
    <li data-md>
     <p>If <var>dictionary</var>["<code>blocked-destinations</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain④">exists</a>:</p>
     <ol>
      <li data-md>
       <p>If its value <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain⑤">contains</a> "<code>script</code>",
 <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append②">append</a> "<code>script</code>" to <var>integrityPolicy</var>’s <a data-link-type="dfn" href="#blocked-destinations" id="ref-for-blocked-destinations">blocked destinations</a>.</p>
     </ol>
    <li data-md>
     <p>If <var>dictionary</var>["<code>endpoints</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists">exists</a>:</p>
     <ol>
      <li data-md>
       <p>Set <var>integrityPolicy</var>’s <a data-link-type="dfn" href="#endpoints" id="ref-for-endpoints">endpoints</a> to <var>dictionary</var>['endpoints'].</p>
     </ol>
    <li data-md>
     <p>Return <var>integrityPolicy</var>.</p>
   </ol>
   <div class="example" id="example-917c0880">
    <a class="self-link" href="#example-917c0880"></a>
  The following header block the request for any external script that’s loaded without integrity
  metadata (or any no-CORS external script).
  
<pre class="language-http highlight">Integrity-Policy: blocked-destinations=(script), endpoints=(integrity-endpoint)
</pre>
    <p>The blocking will also trigger a report to the "<code>integrity-endpoint</code>"
  reporting endpoint (defined by the relevant <code>Reporting-Endpoints</code> header).</p>
    <p>Developers can also register a ReportingObserver for "<code>integrity-violation</code>" to get JavaScript-based
  reports.</p>
   </div>
   <h4 class="heading settled" data-level="3.8.1" id="parse-integrity-policy-headers-section"><span class="secno">3.8.1. </span><span class="content">Parse Integrity-Policy headers</span><a class="self-link" href="#parse-integrity-policy-headers-section"></a></h4>
   
  To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="parse-integrity-policy-headers">parse Integrity-Policy headers</dfn>, given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response">Response</a> <var>response</var>
  and a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container" id="ref-for-policy-container">policy container</a> <var>container</var>, do the following:


   <ol>
    <li data-md>
     <p>Let <var>headers</var> be <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list">header list</a>.</p>
    <li data-md>
     <p>If <var>headers</var> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#header-list-contains" id="ref-for-header-list-contains">contains</a> <code>integrity-policy</code>,
 set <var>container</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-integrity-policy" id="ref-for-policy-container-integrity-policy">integrity policy</a> be the result of running
 <a data-link-type="dfn" href="#processing-an-integrity-policy" id="ref-for-processing-an-integrity-policy">processing an integrity policy</a> with the corresponding <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#header-value" id="ref-for-header-value">header value</a>.</p>
    <li data-md>
     <p>If <var>headers</var> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#header-list-contains" id="ref-for-header-list-contains①">contains</a> <code>integrity-policy-report-only</code>,
 set <var>container</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-report-only-integrity-policy" id="ref-for-policy-container-report-only-integrity-policy">report only integrity policy</a> be the result of running
 <a data-link-type="dfn" href="#processing-an-integrity-policy" id="ref-for-processing-an-integrity-policy①">processing an integrity policy</a> with the corresponding <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#header-value" id="ref-for-header-value①">header value</a>.</p>
   </ol>
   <h4 class="heading settled" data-level="3.8.2" id="should-request-be-blocked-by-integrity-policy-section"><span class="secno">3.8.2. </span><span class="content">Should request be blocked by Integrity Policy</span><a class="self-link" href="#should-request-be-blocked-by-integrity-policy-section"></a></h4>
   
  To determine <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="should-request-be-blocked-by-integrity-policy">should request be blocked by integrity policy</dfn>, given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①">request</a> <var>request</var>,
  do the following:


   <ol>
    <li data-md>
     <p>Let <var>policyContainer</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-policy-container" id="ref-for-concept-request-policy-container">policy container</a>.</p>
    <li data-md>
     <p>Let <var>parsedMetadata</var> be the result of calling <a data-link-type="dfn" href="#parse-metadata" id="ref-for-parse-metadata①">parse metadata</a> with
 <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-integrity-metadata" id="ref-for-concept-request-integrity-metadata">integrity metadata</a>.</p>
    <li data-md>
     <p>If <var>parsedMetadata</var> is not the empty set and
 <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-mode" id="ref-for-concept-request-mode">mode</a> is either "<code>cors</code>" or "<code>same-origin</code>",
 return "Allowed".</p>
    <li data-md>
     <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url">url</a> is <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#is-local" id="ref-for-is-local">local</a>,
 return "Allowed".</p>
    <li data-md>
     <p>Let <var>policy</var> be <var>policyContainer</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-integrity-policy" id="ref-for-policy-container-integrity-policy①">integrity policy</a>.</p>
    <li data-md>
     <p>Let <var>reportPolicy</var> be <var>policyContainer</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-report-only-integrity-policy" id="ref-for-policy-container-report-only-integrity-policy①">report only integrity policy</a>.</p>
    <li data-md>
     <p>If both <var>policy</var> and <var>reportPolicy</var> are empty <a data-link-type="dfn" href="#integrity-policy" id="ref-for-integrity-policy①">integrity policy</a>s, return "Allowed".</p>
    <li data-md>
     <p>Let <var>global</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client">client</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global">global object</a>.</p>
    <li data-md>
     <p>If <var>global</var> is not a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window">Window</a></code> nor a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope">WorkerGlobalScope</a></code>, return "<code>Allowed</code>".</p>
    <li data-md>
     <p>Let <var>block</var> be a boolean, initially false.</p>
    <li data-md>
     <p>Let <var>reportBlock</var> be a boolean, initially false.</p>
    <li data-md>
     <p>If <var>policy</var>’s <a data-link-type="dfn" href="#sources" id="ref-for-sources①">sources</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain⑥">contains</a> "<code>inline</code>"
 and <var>policy</var>’s <a data-link-type="dfn" href="#blocked-destinations" id="ref-for-blocked-destinations①">blocked destinations</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain⑦">contains</a>
 <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination①">destination</a>,
 set <var>block</var> to true.</p>
    <li data-md>
     <p>If <var>reportPolicy</var>’s <a data-link-type="dfn" href="#sources" id="ref-for-sources②">sources</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain⑧">contains</a> "<code>inline</code>"
 and <var>reportPolicy</var>’s <a data-link-type="dfn" href="#blocked-destinations" id="ref-for-blocked-destinations②">blocked destinations</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain⑨">contains</a>
 <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination②">destination</a>,
 set <var>reportBlock</var> to true.</p>
    <li data-md>
     <p>If <var>block</var> is true or <var>reportBlock</var> is true, then <a data-link-type="dfn" href="#report-violation" id="ref-for-report-violation">report violation</a>
 with <var>request</var>, <var>block</var>, <var>reportBlock</var>, <var>policy</var> and <var>reportPolicy</var>.</p>
    <li data-md>
     <p>If <var>block</var> is true, then return "<code>Blocked</code>"; otherwise "<code>Allowed</code>".</p>
   </ol>
   <h4 class="heading settled" data-level="3.8.3" id="report-violations"><span class="secno">3.8.3. </span><span class="content">Report violations</span><a class="self-link" href="#report-violations"></a></h4>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-integrityviolationreportbody"><code><c- g>IntegrityViolationReportBody</c-></code></dfn> : <a data-link-type="idl-name" href="https://w3c.github.io/reporting/#reportbody" id="ref-for-reportbody"><c- n>ReportBody</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="IntegrityViolationReportBody" data-dfn-type="dict-member" data-export data-type="USVString" id="dom-integrityviolationreportbody-documenturl"><code><c- g>documentURL</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="IntegrityViolationReportBody" data-dfn-type="dict-member" data-export data-type="USVString" id="dom-integrityviolationreportbody-blockedurl"><code><c- g>blockedURL</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString②"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="IntegrityViolationReportBody" data-dfn-type="dict-member" data-export data-type="USVString" id="dom-integrityviolationreportbody-destination"><code><c- g>destination</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a>   <dfn class="dfn-paneled idl-code" data-dfn-for="IntegrityViolationReportBody" data-dfn-type="dict-member" data-export data-type="boolean" id="dom-integrityviolationreportbody-reportonly"><code><c- g>reportOnly</c-></code></dfn>;
};
</pre>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="report-violation">report violation</dfn> given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②">Request</a> <var>request</var>, a boolean <var>block</var>,
  a boolean <var>reportBlock</var>, an <a data-link-type="dfn" href="#integrity-policy" id="ref-for-integrity-policy②">integrity policy</a> <var>policy</var>,
  and an <a data-link-type="dfn" href="#integrity-policy" id="ref-for-integrity-policy③">integrity policy</a> <var>reportPolicy</var>, do the following:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert">Assert</a>: <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client①">client</a> is not null.</p>
    <li data-md>
     <p>Let <var>settingsObject</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client②">client</a>.</p>
    <li data-md>
     <p>Let <var>global</var> be <var>settingsObject</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global①">global object</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①">Assert</a>: <var>global</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①">Window</a></code> or a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope①">WorkerGlobalScope</a></code>.</p>
    <li data-md>
     <p>Let <var>url</var> be null.</p>
    <li data-md>
     <p>If <var>global</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window②">Window</a></code>, set <var>url</var> to <var>global</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window">associated Document</a>’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-document-url" id="ref-for-dom-document-url">URL</a></code>.</p>
    <li data-md>
     <p>If <var>global</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope②">WorkerGlobalScope</a></code>, set <var>url</var> to <var>global</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-url" id="ref-for-concept-workerglobalscope-url">URL</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert②">Assert</a>: <var>url</var> is a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URL</a>.</p>
    <li data-md>
     <p>Let <var>documentURL</var> be the result of <a data-link-type="dfn" href="https://w3c.github.io/reporting/#strip-url-for-use-in-reports" id="ref-for-strip-url-for-use-in-reports">strip URL for use in reports</a> on <var>url</var>.</p>
    <li data-md>
     <p>Let <var>blockedURL</var> be the result of <a data-link-type="dfn" href="https://w3c.github.io/reporting/#strip-url-for-use-in-reports" id="ref-for-strip-url-for-use-in-reports①">strip URL for use in reports</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url①">URL</a>.</p>
    <li data-md>
     <p>If <var>block</var> is true, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate">for each</a> <var>endpoint</var> in <var>policy</var>’s <a data-link-type="dfn" href="#endpoints" id="ref-for-endpoints①">endpoints</a>:</p>
     <ol>
      <li data-md>
       <p>Let <var>body</var> be a new <code class="idl"><a data-link-type="idl" href="#dictdef-integrityviolationreportbody" id="ref-for-dictdef-integrityviolationreportbody">IntegrityViolationReportBody</a></code>, initialized as follows:</p>
       <dl>
        <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-integrityviolationreportbody-documenturl" id="ref-for-dom-integrityviolationreportbody-documenturl">documentURL</a></code>
        <dd data-md>
         <p><var>documentURL</var></p>
        <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-integrityviolationreportbody-blockedurl" id="ref-for-dom-integrityviolationreportbody-blockedurl">blockedURL</a></code>
        <dd data-md>
         <p><var>blockedURL</var></p>
        <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-integrityviolationreportbody-destination" id="ref-for-dom-integrityviolationreportbody-destination">destination</a></code>
        <dd data-md>
         <p><var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination③">destination</a></p>
        <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-integrityviolationreportbody-reportonly" id="ref-for-dom-integrityviolationreportbody-reportonly">reportOnly</a></code>
        <dd data-md>
         <p>false</p>
       </dl>
      <li data-md>
       <p><a data-link-type="dfn" href="https://w3c.github.io/reporting/#generate-and-queue-a-report" id="ref-for-generate-and-queue-a-report">Generate and queue a report</a> with the following arguments:</p>
       <dl>
        <dt data-md><a data-link-type="dfn" href="https://w3c.github.io/reporting/#generate-and-queue-a-report-context" id="ref-for-generate-and-queue-a-report-context"><i>context</i></a>
        <dd data-md>
         <p><var>settingsObject</var></p>
        <dt data-md><a data-link-type="dfn" href="https://w3c.github.io/reporting/#generate-and-queue-a-report-type" id="ref-for-generate-and-queue-a-report-type"><i>type</i></a>
        <dd data-md>
         <p>"<code>integrity-violation</code>"</p>
        <dt data-md><a data-link-type="dfn" href="https://w3c.github.io/reporting/#generate-and-queue-a-report-destination" id="ref-for-generate-and-queue-a-report-destination"><i>destination</i></a>
        <dd data-md>
         <p><var>endpoint</var></p>
        <dt data-md><a data-link-type="dfn" href="https://w3c.github.io/reporting/#generate-and-queue-a-report-data" id="ref-for-generate-and-queue-a-report-data"><i>data</i></a>
        <dd data-md>
         <p><var>body</var></p>
       </dl>
     </ol>
    <li data-md>
     <p>If <var>reportBlock</var> is true, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate①">for each</a> <var>endpoint</var> in <var>reportPolicy</var>’s <a data-link-type="dfn" href="#endpoints" id="ref-for-endpoints②">endpoints</a>:</p>
     <ol>
      <li data-md>
       <p>Let <var>reportBody</var> be a new <code class="idl"><a data-link-type="idl" href="#dictdef-integrityviolationreportbody" id="ref-for-dictdef-integrityviolationreportbody①">IntegrityViolationReportBody</a></code>, initialized as follows:</p>
       <dl>
        <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-integrityviolationreportbody-documenturl" id="ref-for-dom-integrityviolationreportbody-documenturl①">documentURL</a></code>
        <dd data-md>
         <p><var>documentURL</var></p>
        <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-integrityviolationreportbody-blockedurl" id="ref-for-dom-integrityviolationreportbody-blockedurl①">blockedURL</a></code>
        <dd data-md>
         <p><var>blockedURL</var></p>
        <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-integrityviolationreportbody-destination" id="ref-for-dom-integrityviolationreportbody-destination①">destination</a></code>
        <dd data-md>
         <p><var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination④">destination</a></p>
        <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-integrityviolationreportbody-reportonly" id="ref-for-dom-integrityviolationreportbody-reportonly①">reportOnly</a></code>
        <dd data-md>
         <p>true</p>
       </dl>
      <li data-md>
       <p><a data-link-type="dfn" href="https://w3c.github.io/reporting/#generate-and-queue-a-report" id="ref-for-generate-and-queue-a-report①">Generate and queue a report</a> with the following arguments:</p>
       <dl>
        <dt data-md><a data-link-type="dfn" href="https://w3c.github.io/reporting/#generate-and-queue-a-report-context" id="ref-for-generate-and-queue-a-report-context①"><i>context</i></a>
        <dd data-md>
         <p><var>settingsObject</var></p>
        <dt data-md><a data-link-type="dfn" href="https://w3c.github.io/reporting/#generate-and-queue-a-report-type" id="ref-for-generate-and-queue-a-report-type①"><i>type</i></a>
        <dd data-md>
         <p>"<code>integrity-violation</code>"</p>
        <dt data-md><a data-link-type="dfn" href="https://w3c.github.io/reporting/#generate-and-queue-a-report-destination" id="ref-for-generate-and-queue-a-report-destination①"><i>destination</i></a>
        <dd data-md>
         <p><var>endpoint</var></p>
        <dt data-md><a data-link-type="dfn" href="https://w3c.github.io/reporting/#generate-and-queue-a-report-data" id="ref-for-generate-and-queue-a-report-data①"><i>data</i></a>
        <dd data-md>
         <p><var>reportBody</var></p>
       </dl>
     </ol>
   </ol>
   <h2 class="heading settled" data-level="4" id="proxies"><span class="secno">4. </span><span class="content">Proxies</span><a class="self-link" href="#proxies"></a></h2>
   <p>Optimizing proxies and other intermediate servers which modify the
  responses MUST ensure that the digest associated
  with those responses stays in sync with the new content. One option
  is to ensure that the <a data-link-type="dfn" href="#integrity-metadata" id="ref-for-integrity-metadata⑦">integrity metadata</a> associated with
  resources is updated. Another
  would be simply to deliver only the canonical version of resources
  for which a page author has requested integrity verification.</p>
   <p>To help inform intermediate servers, those serving the resources SHOULD
  send along with the resource a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7234#section-5.2" id="ref-for-section-5.2"><code>Cache-Control</code></a> header
  with a value of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7234#section-5.2.1.6" id="ref-for-section-5.2.1.6"><code>no-transform</code></a>.</p>
   <h2 class="heading settled" data-level="5" id="security-considerations"><span class="secno">5. </span><span class="content">Security and Privacy Considerations</span><a class="self-link" href="#security-considerations"></a></h2>
   <p><em> This section is not normative.</em></p>
   <h3 class="heading settled" data-level="5.1" id="non-secure-contexts"><span class="secno">5.1. </span><span class="content">Non-secure contexts remain non-secure</span><a class="self-link" href="#non-secure-contexts"></a></h3>
   <p><a data-link-type="dfn" href="#integrity-metadata" id="ref-for-integrity-metadata⑧">Integrity metadata</a> delivered by a context that is not a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context">Secure
  Context</a> such as an HTTP page, only protects an origin against a compromise
  of the server where an external resources is hosted. Network attackers can alter
  the digest in-flight (or remove it entirely, or do absolutely anything else to
  the document), just as they could alter the response the hash is meant to
  validate.  Thus, it is recommended that authors deliver integrity metadata only
  to a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①">Secure Context</a>. See also  <a href="http://www.w3.org/2001/tag/doc/web-https ">Securing the Web</a>.</p>
   <h3 class="heading settled" data-level="5.2" id="hash-collision-attacks"><span class="secno">5.2. </span><span class="content">Hash collision attacks</span><a class="self-link" href="#hash-collision-attacks"></a></h3>
   <p>Digests are only as strong as the hash function used to generate them. It is
  recommended that user agents refuse to support known-weak hashing functions and
  limit supported algorithms to those known to be collision resistant. Examples of
  hashing functions that are not recommended include MD5 and SHA-1. At the time of
  writing, SHA-384 is a good baseline.</p>
   <p>Moreover, it is recommended that user agents re-evaluate their supported hash
  functions on a regular basis and deprecate support for those functions shown to
  be insecure. Over time, hash functions may be shown to be much weaker than
  expected and, in some cases, broken, so it is important that user agents stay
  aware of these developments.</p>
   <h3 class="heading settled" data-level="5.3" id="cross-origin-data-leakage"><span class="secno">5.3. </span><span class="content">Cross-origin data leakage</span><a class="self-link" href="#cross-origin-data-leakage"></a></h3>
   <p>This specification requires integrity-protected cross-origin requests to use the
  <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#cors-protocol" id="ref-for-cors-protocol">CORS protocol</a> to ensure that the resource’s content is explicitly shared
  with the requestor. If that requirement were omitted,
  attackers could violate the <a href="http://www.w3.org/Security/wiki/Same_Origin_Policy">same-origin policy</a>
  and determine whether a cross-origin resource has certain content.</p>
   <p>Attackers would attempt to load the resource with a known digest, and
  watch for load failures. If the load fails, the attacker could surmise
  that the response didn’t match the hash and thereby gain some insight into
  its contents. This might reveal, for example, whether or not a user is
  logged into a particular service.</p>
   <p>Moreover, attackers could brute-force specific values in an otherwise
  static resource. Consider a JSON response that looks like this:</p>
   <div class="example" id="example-6c05895b">
    <a class="self-link" href="#example-6c05895b"></a>
  
<pre class="highlight"><c- p>{</c-><c- f>"status"</c-><c- p>:</c-> <c- u>"authenticated"</c-><c- p>,</c-> <c- f>"username"</c-><c- p>:</c-> <c- u>"admin"</c-><c- p>}</c->
</pre>
   </div>
   <p>An attacker could precompute hashes for the response with a variety of
  common usernames, and specify those hashes while repeatedly attempting
  to load the document. A successful load would confirm that the attacker
  has correctly guessed the username.</p>
   <h2 class="heading settled" data-level="6" id="acknowledgements"><span class="secno">6. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
   <p>Much of the content here is inspired heavily by Gervase Markham’s <a href="http://www.gerv.net/security/link-fingerprints/">Link Fingerprints</a>
  concept as well as WHATWG’s <a href="https://wiki.whatwg.org/wiki/Link_Hashes">Link Hashes</a>.</p>
   <p>A special thanks to Mike West for his invaluable contributions to the initial
  version of this spec. Thanks to Brad Hill, Anne van Kesteren, Jonathan
  Kingston, Fatih Kilic, Mark Nottingham, Sergey Shekyan, Dan Veditz, Eduardo Vela,
  Tanvi Vyas, Yoav Weiss, and Michal Zalewski for providing invaluable feedback.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification.

    </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a>

    </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this:

    </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a>
        
    <p>This is an example of an informative example.
    </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this:

    </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <details class="wpt-tests-block" dir="ltr" lang="en" open>
    <summary>Tests</summary>
    <p>Tests relating to the content of this specification
                     may be documented in “Tests” blocks like this one.
                     Any such block is non-normative.</p>
    <ul class="wpt-tests-list"></ul>
    <hr>
   </details>
   <section>
    <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
    <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm.

    </p>
    <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize.
</p>
   </section>
  </div>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#base64-encoding">base64 encoding</a><span>, in § 2</span>
   <li><a href="#blocked-destinations">blocked destinations</a><span>, in § 3.8</span>
   <li><a href="#dom-integrityviolationreportbody-blockedurl">blockedURL</a><span>, in § 3.8.3</span>
   <li>
    destination
    <ul>
     <li><a href="#destination">definition of</a><span>, in § 3.8</span>
     <li><a href="#dom-integrityviolationreportbody-destination">dict-member for IntegrityViolationReportBody</a><span>, in § 3.8.3</span>
    </ul>
   <li><a href="#digest">digest</a><span>, in § 2</span>
   <li><a href="#does-response-match-metadatalist">Do bytes match metadataList?</a><span>, in § 3.3.3</span>
   <li><a href="#dom-integrityviolationreportbody-documenturl">documentURL</a><span>, in § 3.8.3</span>
   <li><a href="#endpoints">endpoints</a><span>, in § 3.8</span>
   <li><a href="#grammardef-hash-expression">hash-expression</a><span>, in § 3.5</span>
   <li><a href="#grammardef-hash-with-options">hash-with-options</a><span>, in § 3.5</span>
   <li><a href="#integrity-metadata">integrity metadata</a><span>, in § 3.1</span>
   <li><a href="#grammardef-integrity-metadata">integrity-metadata</a><span>, in § 3.5</span>
   <li><a href="#integrity-policy">integrity policy</a><span>, in § 3.8</span>
   <li><a href="#dictdef-integrityviolationreportbody">IntegrityViolationReportBody</a><span>, in § 3.8.3</span>
   <li><a href="#grammardef-option-expression">option-expression</a><span>, in § 3.5</span>
   <li><a href="#parse-integrity-policy-headers">parse Integrity-Policy headers</a><span>, in § 3.8.1</span>
   <li><a href="#parse-metadata">parse metadata</a><span>, in § 3.3.2</span>
   <li><a href="#processing-an-integrity-policy">processing an integrity policy</a><span>, in § 3.8</span>
   <li><a href="#dom-integrityviolationreportbody-reportonly">reportOnly</a><span>, in § 3.8.3</span>
   <li><a href="#report-violation">report violation</a><span>, in § 3.8.3</span>
   <li><a href="#should-request-be-blocked-by-integrity-policy">should request be blocked by integrity policy</a><span>, in § 3.8.2</span>
   <li><a href="#source">source</a><span>, in § 3.8</span>
   <li><a href="#sources">sources</a><span>, in § 3.8</span>
   <li><a href="#valid-sri-hash-algorithm-token">valid SRI hash algorithm token</a><span>, in § 2</span>
   <li><a href="#valid-sri-hash-algorithm-token-set">valid SRI hash algorithm token set</a><span>, in § 2</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[ABNF]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c6544229">VCHAR</span>
     <li><span class="dfn-paneled" id="bed34579">WSP</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSP]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="aa9871ba">base64-value</span>
     <li><span class="dfn-paneled" id="b123cff6">hash-algorithm</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="5a84ded6">URL</span>
    </ul>
   <li>
    <a data-link-type="biblio">[Fetch]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="857d5516">client</span>
     <li><span class="dfn-paneled" id="d5434eef">contains</span>
     <li><span class="dfn-paneled" id="a2a30ba8">CORS protocol</span>
     <li><span class="dfn-paneled" id="3ae34c95">destination</span>
     <li><span class="dfn-paneled" id="e56c6177">destination type</span>
     <li><span class="dfn-paneled" id="5c66de35">get a structured field value</span>
     <li><span class="dfn-paneled" id="d85a6c84">header list</span>
     <li><span class="dfn-paneled" id="f7b00a8b">header list <small>(for response)</small></span>
     <li><span class="dfn-paneled" id="1534f1eb">header name</span>
     <li><span class="dfn-paneled" id="c07f8014">header value</span>
     <li><span class="dfn-paneled" id="d79a826f">integrity metadata</span>
     <li><span class="dfn-paneled" id="8f26de31">is local</span>
     <li><span class="dfn-paneled" id="cb98f71f">mode</span>
     <li><span class="dfn-paneled" id="86efadaf">policy container</span>
     <li><span class="dfn-paneled" id="55213b5b">request</span>
     <li><span class="dfn-paneled" id="ee7bba09">response</span>
     <li><span class="dfn-paneled" id="dc1cd39b">URL</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="5d7209e9">Window</span>
     <li><span class="dfn-paneled" id="83c59a3a">WorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="3349d69f">associated Document</span>
     <li><span class="dfn-paneled" id="8a30477b">global object</span>
     <li><span class="dfn-paneled" id="71a49668">integrity policy</span>
     <li><span class="dfn-paneled" id="086e3aff">origin</span>
     <li><span class="dfn-paneled" id="b33787b2">policy container</span>
     <li><span class="dfn-paneled" id="1471f9a3">report only integrity policy</span>
     <li><span class="dfn-paneled" id="7393da89">same origin</span>
     <li><span class="dfn-paneled" id="65181da8">secure context</span>
     <li><span class="dfn-paneled" id="c5b6dcb3">url</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="53275e46">append <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="a3b18719">append <small>(for set)</small></span>
     <li><span class="dfn-paneled" id="6f2dfa22">ASCII lowercase</span>
     <li><span class="dfn-paneled" id="77b4c09a">assert</span>
     <li><span class="dfn-paneled" id="ae8def21">contain</span>
     <li><span class="dfn-paneled" id="f937b7b6">continue</span>
     <li><span class="dfn-paneled" id="75393c04">exist <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="1243a891">exist <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="16d07e10">for each</span>
     <li><span class="dfn-paneled" id="6b815fdd">is empty</span>
     <li><span class="dfn-paneled" id="649608b9">list</span>
     <li><span class="dfn-paneled" id="692595fe">ordered set</span>
     <li><span class="dfn-paneled" id="e5fc5b88">strictly split</span>
     <li><span class="dfn-paneled" id="984221ca">struct</span>
    </ul>
   <li>
    <a data-link-type="biblio">[REPORTING-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="188c6617">ReportBody</span>
     <li><span class="dfn-paneled" id="0939d6e1">context</span>
     <li><span class="dfn-paneled" id="5c9158ae">data</span>
     <li><span class="dfn-paneled" id="35ccaa89">destination</span>
     <li><span class="dfn-paneled" id="7ed9d314">generate and queue a report</span>
     <li><span class="dfn-paneled" id="093a0772">strip URL for use in reports</span>
     <li><span class="dfn-paneled" id="3113ad77">type</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC7234]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="b3a57b71">Cache-Control</span>
     <li><span class="dfn-paneled" id="5f693367">no-transform</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC8288]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="d1364af2">link</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC9651]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="42bcaebe">Dictionary</span>
     <li><span class="dfn-paneled" id="998ca7a7">inner list</span>
     <li><span class="dfn-paneled" id="f4486aa1">token</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SHA2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="104bce7f">SHA-2</span>
     <li><span class="dfn-paneled" id="0de10dfb">SHA-256</span>
     <li><span class="dfn-paneled" id="bbbbe32e">SHA-384</span>
     <li><span class="dfn-paneled" id="92ff7496">SHA-512</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="dcffbccd">URL</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="b0d7f3c3">USVString</span>
     <li><span class="dfn-paneled" id="5372cca8">boolean</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-abnf">[ABNF]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://www.rfc-editor.org/rfc/rfc5234"><cite>Augmented BNF for Syntax Specifications: ABNF</cite></a>. January 2008. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>
   <dt id="biblio-csp">[CSP]
   <dd>Mike West; Antonio Sartori. <a href="https://w3c.github.io/webappsec-csp/"><cite>Content Security Policy Level 3</cite></a>. URL: <a href="https://w3c.github.io/webappsec-csp/">https://w3c.github.io/webappsec-csp/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[Fetch]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-mime-types">[MIME-TYPES]
   <dd>N. Freed; N. Borenstein. <a href="https://www.rfc-editor.org/rfc/rfc2046"><cite>Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types</cite></a>. November 1996. Draft Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc2046">https://www.rfc-editor.org/rfc/rfc2046</a>
   <dt id="biblio-reporting-1">[REPORTING-1]
   <dd>Douglas Creager; Ian Clelland; Mike West. <a href="https://w3c.github.io/reporting/"><cite>Reporting API</cite></a>. URL: <a href="https://w3c.github.io/reporting/">https://w3c.github.io/reporting/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-rfc4648">[RFC4648]
   <dd>S. Josefsson. <a href="https://www.rfc-editor.org/rfc/rfc4648"><cite>The Base16, Base32, and Base64 Data Encodings</cite></a>. October 2006. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>
   <dt id="biblio-rfc7234">[RFC7234]
   <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc7234.html"><cite>Hypertext Transfer Protocol (HTTP/1.1): Caching</cite></a>. June 2014. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7234.html">https://httpwg.org/specs/rfc7234.html</a>
   <dt id="biblio-rfc8288">[RFC8288]
   <dd>M. Nottingham. <a href="https://httpwg.org/specs/rfc8288.html"><cite>Web Linking</cite></a>. October 2017. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc8288.html">https://httpwg.org/specs/rfc8288.html</a>
   <dt id="biblio-rfc9651">[RFC9651]
   <dd>M. Nottingham; P-H. Kamp. <a href="https://www.rfc-editor.org/rfc/rfc9651"><cite>Structured Field Values for HTTP</cite></a>. September 2024. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9651">https://www.rfc-editor.org/rfc/rfc9651</a>
   <dt id="biblio-sha2">[SHA2]
   <dd><a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf"><cite>FIPS PUB 180-4, Secure Hash Standard</cite></a>. URL: <a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-rfc1035">[RFC1035]
   <dd>P. Mockapetris. <a href="https://www.rfc-editor.org/rfc/rfc1035"><cite>Domain names - implementation and specification</cite></a>. November 1987. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc1035">https://www.rfc-editor.org/rfc/rfc1035</a>
   <dt id="biblio-rfc6797">[RFC6797]
   <dd>J. Hodges; C. Jackson; A. Barth. <a href="https://www.rfc-editor.org/rfc/rfc6797"><cite>HTTP Strict Transport Security (HSTS)</cite></a>. November 2012. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6797">https://www.rfc-editor.org/rfc/rfc6797</a>
   <dt id="biblio-rfc7469">[RFC7469]
   <dd>C. Evans; C. Palmer; R. Sleevi. <a href="https://www.rfc-editor.org/rfc/rfc7469"><cite>Public Key Pinning Extension for HTTP</cite></a>. April 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7469">https://www.rfc-editor.org/rfc/rfc7469</a>
   <dt id="biblio-tls">[TLS]
   <dd>E. Rescorla. <a href="https://www.rfc-editor.org/rfc/rfc8446"><cite>The Transport Layer Security (TLS) Protocol Version 1.3</cite></a>. August 2018. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>dictionary</c-> <a href="#dictdef-integrityviolationreportbody"><code><c- g>IntegrityViolationReportBody</c-></code></a> : <a data-link-type="idl-name" href="https://w3c.github.io/reporting/#reportbody"><c- n>ReportBody</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString" href="#dom-integrityviolationreportbody-documenturl"><code><c- g>documentURL</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString" href="#dom-integrityviolationreportbody-blockedurl"><code><c- g>blockedURL</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-type="USVString" href="#dom-integrityviolationreportbody-destination"><code><c- g>destination</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a>   <a data-type="boolean" href="#dom-integrityviolationreportbody-reportonly"><code><c- g>reportOnly</c-></code></a>;
};

</pre>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"086e3aff": {"dfnID":"086e3aff","dfnText":"origin","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-origin"}],"title":"2. Key Concepts and Terminology"}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin"},
"0939d6e1": {"dfnID":"0939d6e1","dfnText":"context","external":true,"refSections":[{"refs":[{"id":"ref-for-generate-and-queue-a-report-context"},{"id":"ref-for-generate-and-queue-a-report-context\u2460"}],"title":"3.8.3. Report violations"}],"url":"https://w3c.github.io/reporting/#generate-and-queue-a-report-context"},
"093a0772": {"dfnID":"093a0772","dfnText":"strip URL for use in reports","external":true,"refSections":[{"refs":[{"id":"ref-for-strip-url-for-use-in-reports"},{"id":"ref-for-strip-url-for-use-in-reports\u2460"}],"title":"3.8.3. Report violations"}],"url":"https://w3c.github.io/reporting/#strip-url-for-use-in-reports"},
"0de10dfb": {"dfnID":"0de10dfb","dfnText":"SHA-256","external":true,"refSections":[{"refs":[{"id":"ref-for-something"},{"id":"ref-for-something\u2460"},{"id":"ref-for-something\u2461"},{"id":"ref-for-something\u2462"},{"id":"ref-for-something\u2463"},{"id":"ref-for-something\u2464"},{"id":"ref-for-something\u2465"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-something\u2466"}],"title":"3.1. Integrity metadata"},{"refs":[{"id":"ref-for-something\u2467"},{"id":"ref-for-something\u2468"},{"id":"ref-for-something\u2460\u24ea"}],"title":"3.2. Cryptographic hash functions"},{"refs":[{"id":"ref-for-something\u2460\u2460"},{"id":"ref-for-something\u2460\u2461"},{"id":"ref-for-something\u2460\u2462"}],"title":"3.2.2. Priority"},{"refs":[{"id":"ref-for-something\u2460\u2463"},{"id":"ref-for-something\u2460\u2464"}],"title":"3.3.4. Do bytes match metadataList?"}],"url":"https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#"},
"104bce7f": {"dfnID":"104bce7f","dfnText":"SHA-2","external":true,"refSections":[{"refs":[{"id":"ref-for-something"},{"id":"ref-for-something\u2460"},{"id":"ref-for-something\u2461"},{"id":"ref-for-something\u2462"},{"id":"ref-for-something\u2463"},{"id":"ref-for-something\u2464"},{"id":"ref-for-something\u2465"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-something\u2466"}],"title":"3.1. Integrity metadata"},{"refs":[{"id":"ref-for-something\u2467"},{"id":"ref-for-something\u2468"},{"id":"ref-for-something\u2460\u24ea"}],"title":"3.2. Cryptographic hash functions"},{"refs":[{"id":"ref-for-something\u2460\u2460"},{"id":"ref-for-something\u2460\u2461"},{"id":"ref-for-something\u2460\u2462"}],"title":"3.2.2. Priority"},{"refs":[{"id":"ref-for-something\u2460\u2463"},{"id":"ref-for-something\u2460\u2464"}],"title":"3.3.4. Do bytes match metadataList?"}],"url":"https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#"},
"1243a891": {"dfnID":"1243a891","dfnText":"exist (for map)","external":true,"refSections":[{"refs":[{"id":"ref-for-map-exists"}],"title":"3.8. Integrity-Policy"}],"url":"https://infra.spec.whatwg.org/#map-exists"},
"1471f9a3": {"dfnID":"1471f9a3","dfnText":"report only integrity policy","external":true,"refSections":[{"refs":[{"id":"ref-for-policy-container-report-only-integrity-policy"}],"title":"3.8.1. Parse Integrity-Policy headers"},{"refs":[{"id":"ref-for-policy-container-report-only-integrity-policy\u2460"}],"title":"3.8.2. Should request be blocked by Integrity Policy"}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-report-only-integrity-policy"},
"1534f1eb": {"dfnID":"1534f1eb","dfnText":"header name","external":true,"refSections":[{"refs":[{"id":"ref-for-header-name"}],"title":"3.8. Integrity-Policy"}],"url":"https://fetch.spec.whatwg.org/#header-name"},
"16d07e10": {"dfnID":"16d07e10","dfnText":"for each","external":true,"refSections":[{"refs":[{"id":"ref-for-list-iterate"},{"id":"ref-for-list-iterate\u2460"}],"title":"3.8.3. Report violations"}],"url":"https://infra.spec.whatwg.org/#list-iterate"},
"188c6617": {"dfnID":"188c6617","dfnText":"ReportBody","external":true,"refSections":[{"refs":[{"id":"ref-for-reportbody"}],"title":"3.8.3. Report violations"}],"url":"https://w3c.github.io/reporting/#reportbody"},
"3113ad77": {"dfnID":"3113ad77","dfnText":"type","external":true,"refSections":[{"refs":[{"id":"ref-for-generate-and-queue-a-report-type"},{"id":"ref-for-generate-and-queue-a-report-type\u2460"}],"title":"3.8.3. Report violations"}],"url":"https://w3c.github.io/reporting/#generate-and-queue-a-report-type"},
"3349d69f": {"dfnID":"3349d69f","dfnText":"associated Document","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-document-window"}],"title":"3.8.3. Report violations"}],"url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window"},
"35ccaa89": {"dfnID":"35ccaa89","dfnText":"destination","external":true,"refSections":[{"refs":[{"id":"ref-for-generate-and-queue-a-report-destination"},{"id":"ref-for-generate-and-queue-a-report-destination\u2460"}],"title":"3.8.3. Report violations"}],"url":"https://w3c.github.io/reporting/#generate-and-queue-a-report-destination"},
"3ae34c95": {"dfnID":"3ae34c95","dfnText":"destination","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-destination"}],"title":"3.8. Integrity-Policy"},{"refs":[{"id":"ref-for-concept-request-destination\u2460"},{"id":"ref-for-concept-request-destination\u2461"}],"title":"3.8.2. Should request be blocked by Integrity Policy"},{"refs":[{"id":"ref-for-concept-request-destination\u2462"},{"id":"ref-for-concept-request-destination\u2463"}],"title":"3.8.3. Report violations"}],"url":"https://fetch.spec.whatwg.org/#concept-request-destination"},
"42bcaebe": {"dfnID":"42bcaebe","dfnText":"Dictionary","external":true,"refSections":[{"refs":[{"id":"ref-for-name-dictionaries"}],"title":"3.8. Integrity-Policy"}],"url":"https://tools.ietf.org/html/rfc9651#name-dictionaries"},
"53275e46": {"dfnID":"53275e46","dfnText":"append (for list)","external":true,"refSections":[{"refs":[{"id":"ref-for-list-append"}],"title":"3.3.2. Parse metadata"},{"refs":[{"id":"ref-for-list-append\u2460"},{"id":"ref-for-list-append\u2461"}],"title":"3.8. Integrity-Policy"}],"url":"https://infra.spec.whatwg.org/#list-append"},
"5372cca8": {"dfnID":"5372cca8","dfnText":"boolean","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-boolean"}],"title":"3.8.3. Report violations"}],"url":"https://webidl.spec.whatwg.org/#idl-boolean"},
"55213b5b": {"dfnID":"55213b5b","dfnText":"request","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request"}],"title":"3.1. Integrity metadata"},{"refs":[{"id":"ref-for-concept-request\u2460"}],"title":"3.8.2. Should request be blocked by Integrity Policy"},{"refs":[{"id":"ref-for-concept-request\u2461"}],"title":"3.8.3. Report violations"}],"url":"https://fetch.spec.whatwg.org/#concept-request"},
"5a84ded6": {"dfnID":"5a84ded6","dfnText":"URL","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-document-url"}],"title":"3.8.3. Report violations"}],"url":"https://dom.spec.whatwg.org/#dom-document-url"},
"5c66de35": {"dfnID":"5c66de35","dfnText":"get a structured field value","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-header-list-get-structured-header"}],"title":"3.8. Integrity-Policy"}],"url":"https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header"},
"5c9158ae": {"dfnID":"5c9158ae","dfnText":"data","external":true,"refSections":[{"refs":[{"id":"ref-for-generate-and-queue-a-report-data"},{"id":"ref-for-generate-and-queue-a-report-data\u2460"}],"title":"3.8.3. Report violations"}],"url":"https://w3c.github.io/reporting/#generate-and-queue-a-report-data"},
"5d7209e9": {"dfnID":"5d7209e9","dfnText":"Window","external":true,"refSections":[{"refs":[{"id":"ref-for-window"}],"title":"3.8.2. Should request be blocked by Integrity Policy"},{"refs":[{"id":"ref-for-window\u2460"},{"id":"ref-for-window\u2461"}],"title":"3.8.3. Report violations"}],"url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window"},
"5f693367": {"dfnID":"5f693367","dfnText":"no-transform","external":true,"refSections":[{"refs":[{"id":"ref-for-section-5.2.1.6"}],"title":"4. Proxies"}],"url":"https://tools.ietf.org/html/rfc7234#section-5.2.1.6"},
"649608b9": {"dfnID":"649608b9","dfnText":"list","external":true,"refSections":[{"refs":[{"id":"ref-for-list"}],"title":"3.8. Integrity-Policy"}],"url":"https://infra.spec.whatwg.org/#list"},
"65181da8": {"dfnID":"65181da8","dfnText":"secure context","external":true,"refSections":[{"refs":[{"id":"ref-for-secure-context"},{"id":"ref-for-secure-context\u2460"}],"title":"5.1. Non-secure contexts remain non-secure"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#secure-context"},
"692595fe": {"dfnID":"692595fe","dfnText":"ordered set","external":true,"refSections":[{"refs":[{"id":"ref-for-ordered-set"}],"title":"2. Key Concepts and Terminology"}],"url":"https://infra.spec.whatwg.org/#ordered-set"},
"6b815fdd": {"dfnID":"6b815fdd","dfnText":"is empty","external":true,"refSections":[{"refs":[{"id":"ref-for-list-is-empty"}],"title":"3.3.4. Do bytes match metadataList?"}],"url":"https://infra.spec.whatwg.org/#list-is-empty"},
"6f2dfa22": {"dfnID":"6f2dfa22","dfnText":"ASCII lowercase","external":true,"refSections":[{"refs":[{"id":"ref-for-ascii-lowercase"}],"title":"2. Key Concepts and Terminology"}],"url":"https://infra.spec.whatwg.org/#ascii-lowercase"},
"71a49668": {"dfnID":"71a49668","dfnText":"integrity policy","external":true,"refSections":[{"refs":[{"id":"ref-for-policy-container-integrity-policy"}],"title":"3.8.1. Parse Integrity-Policy headers"},{"refs":[{"id":"ref-for-policy-container-integrity-policy\u2460"}],"title":"3.8.2. Should request be blocked by Integrity Policy"}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-integrity-policy"},
"7393da89": {"dfnID":"7393da89","dfnText":"same origin","external":true,"refSections":[{"refs":[{"id":"ref-for-same-origin"}],"title":"2. Key Concepts and Terminology"}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#same-origin"},
"75393c04": {"dfnID":"75393c04","dfnText":"exist (for list)","external":true,"refSections":[{"refs":[{"id":"ref-for-list-contain"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-list-contain\u2460"}],"title":"3.3.2. Parse metadata"},{"refs":[{"id":"ref-for-list-contain\u2461"},{"id":"ref-for-list-contain\u2462"},{"id":"ref-for-list-contain\u2463"},{"id":"ref-for-list-contain\u2464"}],"title":"3.8. Integrity-Policy"},{"refs":[{"id":"ref-for-list-contain\u2465"},{"id":"ref-for-list-contain\u2466"},{"id":"ref-for-list-contain\u2467"},{"id":"ref-for-list-contain\u2468"}],"title":"3.8.2. Should request be blocked by Integrity Policy"}],"url":"https://infra.spec.whatwg.org/#list-contain"},
"77b4c09a": {"dfnID":"77b4c09a","dfnText":"assert","external":true,"refSections":[{"refs":[{"id":"ref-for-assert"},{"id":"ref-for-assert\u2460"},{"id":"ref-for-assert\u2461"}],"title":"3.8.3. Report violations"}],"url":"https://infra.spec.whatwg.org/#assert"},
"7ed9d314": {"dfnID":"7ed9d314","dfnText":"generate and queue a report","external":true,"refSections":[{"refs":[{"id":"ref-for-generate-and-queue-a-report"},{"id":"ref-for-generate-and-queue-a-report\u2460"}],"title":"3.8.3. Report violations"}],"url":"https://w3c.github.io/reporting/#generate-and-queue-a-report"},
"83c59a3a": {"dfnID":"83c59a3a","dfnText":"WorkerGlobalScope","external":true,"refSections":[{"refs":[{"id":"ref-for-workerglobalscope"}],"title":"3.8.2. Should request be blocked by Integrity Policy"},{"refs":[{"id":"ref-for-workerglobalscope\u2460"},{"id":"ref-for-workerglobalscope\u2461"}],"title":"3.8.3. Report violations"}],"url":"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope"},
"857d5516": {"dfnID":"857d5516","dfnText":"client","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-client"}],"title":"3.8.2. Should request be blocked by Integrity Policy"},{"refs":[{"id":"ref-for-concept-request-client\u2460"},{"id":"ref-for-concept-request-client\u2461"}],"title":"3.8.3. Report violations"}],"url":"https://fetch.spec.whatwg.org/#concept-request-client"},
"86efadaf": {"dfnID":"86efadaf","dfnText":"policy container","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-policy-container"}],"title":"3.8.2. Should request be blocked by Integrity Policy"}],"url":"https://fetch.spec.whatwg.org/#concept-request-policy-container"},
"8a30477b": {"dfnID":"8a30477b","dfnText":"global object","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-settings-object-global"}],"title":"3.8.2. Should request be blocked by Integrity Policy"},{"refs":[{"id":"ref-for-concept-settings-object-global\u2460"}],"title":"3.8.3. Report violations"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"},
"8f26de31": {"dfnID":"8f26de31","dfnText":"is local","external":true,"refSections":[{"refs":[{"id":"ref-for-is-local"}],"title":"3.8.2. Should request be blocked by Integrity Policy"}],"url":"https://fetch.spec.whatwg.org/#is-local"},
"92ff7496": {"dfnID":"92ff7496","dfnText":"SHA-512","external":true,"refSections":[{"refs":[{"id":"ref-for-something"},{"id":"ref-for-something\u2460"},{"id":"ref-for-something\u2461"},{"id":"ref-for-something\u2462"},{"id":"ref-for-something\u2463"},{"id":"ref-for-something\u2464"},{"id":"ref-for-something\u2465"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-something\u2466"}],"title":"3.1. Integrity metadata"},{"refs":[{"id":"ref-for-something\u2467"},{"id":"ref-for-something\u2468"},{"id":"ref-for-something\u2460\u24ea"}],"title":"3.2. Cryptographic hash functions"},{"refs":[{"id":"ref-for-something\u2460\u2460"},{"id":"ref-for-something\u2460\u2461"},{"id":"ref-for-something\u2460\u2462"}],"title":"3.2.2. Priority"},{"refs":[{"id":"ref-for-something\u2460\u2463"},{"id":"ref-for-something\u2460\u2464"}],"title":"3.3.4. Do bytes match metadataList?"}],"url":"https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#"},
"984221ca": {"dfnID":"984221ca","dfnText":"struct","external":true,"refSections":[{"refs":[{"id":"ref-for-struct"}],"title":"3.8. Integrity-Policy"}],"url":"https://infra.spec.whatwg.org/#struct"},
"998ca7a7": {"dfnID":"998ca7a7","dfnText":"inner list","external":true,"refSections":[{"refs":[{"id":"ref-for-name-inner-lists"}],"title":"3.8. Integrity-Policy"}],"url":"https://tools.ietf.org/html/rfc9651#name-inner-lists"},
"a2a30ba8": {"dfnID":"a2a30ba8","dfnText":"CORS protocol","external":true,"refSections":[{"refs":[{"id":"ref-for-cors-protocol"}],"title":"5.3. Cross-origin data leakage"}],"url":"https://fetch.spec.whatwg.org/#cors-protocol"},
"a3b18719": {"dfnID":"a3b18719","dfnText":"append (for set)","external":true,"refSections":[{"refs":[{"id":"ref-for-set-append"},{"id":"ref-for-set-append\u2460"}],"title":"3.3.3. Get the strongest metadata from set"}],"url":"https://infra.spec.whatwg.org/#set-append"},
"aa9871ba": {"dfnID":"aa9871ba","dfnText":"base64-value","external":true,"refSections":[{"refs":[{"id":"ref-for-grammardef-base64-value"}],"title":"2.1. Grammatical Concepts"},{"refs":[{"id":"ref-for-grammardef-base64-value\u2460"}],"title":"3.5. The integrity attribute"}],"url":"https://w3c.github.io/webappsec-csp/#grammardef-base64-value"},
"ae8def21": {"dfnID":"ae8def21","dfnText":"contain","external":true,"refSections":[{"refs":[{"id":"ref-for-list-contain"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-list-contain\u2460"}],"title":"3.3.2. Parse metadata"},{"refs":[{"id":"ref-for-list-contain\u2461"},{"id":"ref-for-list-contain\u2462"},{"id":"ref-for-list-contain\u2463"},{"id":"ref-for-list-contain\u2464"}],"title":"3.8. Integrity-Policy"},{"refs":[{"id":"ref-for-list-contain\u2465"},{"id":"ref-for-list-contain\u2466"},{"id":"ref-for-list-contain\u2467"},{"id":"ref-for-list-contain\u2468"}],"title":"3.8.2. Should request be blocked by Integrity Policy"}],"url":"https://infra.spec.whatwg.org/#list-contain"},
"b0d7f3c3": {"dfnID":"b0d7f3c3","dfnText":"USVString","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-USVString"},{"id":"ref-for-idl-USVString\u2460"},{"id":"ref-for-idl-USVString\u2461"}],"title":"3.8.3. Report violations"}],"url":"https://webidl.spec.whatwg.org/#idl-USVString"},
"b123cff6": {"dfnID":"b123cff6","dfnText":"hash-algorithm","external":true,"refSections":[{"refs":[{"id":"ref-for-grammardef-hash-algorithm"}],"title":"2.1. Grammatical Concepts"},{"refs":[{"id":"ref-for-grammardef-hash-algorithm\u2460"}],"title":"3.5. The integrity attribute"}],"url":"https://w3c.github.io/webappsec-csp/#grammardef-hash-algorithm"},
"b33787b2": {"dfnID":"b33787b2","dfnText":"policy container","external":true,"refSections":[{"refs":[{"id":"ref-for-policy-container"}],"title":"3.8.1. Parse Integrity-Policy headers"}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#policy-container"},
"b3a57b71": {"dfnID":"b3a57b71","dfnText":"Cache-Control","external":true,"refSections":[{"refs":[{"id":"ref-for-section-5.2"}],"title":"4. Proxies"}],"url":"https://tools.ietf.org/html/rfc7234#section-5.2"},
"base64-encoding": {"dfnID":"base64-encoding","dfnText":"base64 encoding","external":false,"refSections":[{"refs":[{"id":"ref-for-base64-encoding"}],"title":"3.1. Integrity metadata"},{"refs":[{"id":"ref-for-base64-encoding\u2460"}],"title":"3.3.1. Apply algorithm to bytes"}],"url":"#base64-encoding"},
"bbbbe32e": {"dfnID":"bbbbe32e","dfnText":"SHA-384","external":true,"refSections":[{"refs":[{"id":"ref-for-something"},{"id":"ref-for-something\u2460"},{"id":"ref-for-something\u2461"},{"id":"ref-for-something\u2462"},{"id":"ref-for-something\u2463"},{"id":"ref-for-something\u2464"},{"id":"ref-for-something\u2465"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-something\u2466"}],"title":"3.1. Integrity metadata"},{"refs":[{"id":"ref-for-something\u2467"},{"id":"ref-for-something\u2468"},{"id":"ref-for-something\u2460\u24ea"}],"title":"3.2. Cryptographic hash functions"},{"refs":[{"id":"ref-for-something\u2460\u2460"},{"id":"ref-for-something\u2460\u2461"},{"id":"ref-for-something\u2460\u2462"}],"title":"3.2.2. Priority"},{"refs":[{"id":"ref-for-something\u2460\u2463"},{"id":"ref-for-something\u2460\u2464"}],"title":"3.3.4. Do bytes match metadataList?"}],"url":"https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#"},
"bed34579": {"dfnID":"bed34579","dfnText":"WSP","external":true,"refSections":[{"refs":[{"id":"58fa9b5f0"},{"id":"ref-for-appendix-B.1"},{"id":"ref-for-appendix-B.1\u2460"}],"title":"2.1. Grammatical Concepts"},{"refs":[{"id":"ref-for-appendix-B.1\u2461"},{"id":"ref-for-appendix-B.1\u2462"},{"id":"ref-for-appendix-B.1\u2463"},{"id":"ref-for-appendix-B.1\u2464"},{"id":"ref-for-appendix-B.1\u2465"}],"title":"3.5. The integrity attribute"}],"url":"https://tools.ietf.org/html/rfc5234#appendix-B.1"},
"blocked-destinations": {"dfnID":"blocked-destinations","dfnText":"blocked destinations","external":false,"refSections":[{"refs":[{"id":"ref-for-blocked-destinations"}],"title":"3.8. Integrity-Policy"},{"refs":[{"id":"ref-for-blocked-destinations\u2460"},{"id":"ref-for-blocked-destinations\u2461"}],"title":"3.8.2. Should request be blocked by Integrity Policy"}],"url":"#blocked-destinations"},
"c07f8014": {"dfnID":"c07f8014","dfnText":"header value","external":true,"refSections":[{"refs":[{"id":"ref-for-header-value"},{"id":"ref-for-header-value\u2460"}],"title":"3.8.1. Parse Integrity-Policy headers"}],"url":"https://fetch.spec.whatwg.org/#header-value"},
"c5b6dcb3": {"dfnID":"c5b6dcb3","dfnText":"url","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-workerglobalscope-url"}],"title":"3.8.3. Report violations"}],"url":"https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-url"},
"c6544229": {"dfnID":"c6544229","dfnText":"VCHAR","external":true,"refSections":[{"refs":[{"id":"58fa9b5f0"},{"id":"ref-for-appendix-B.1"},{"id":"ref-for-appendix-B.1\u2460"}],"title":"2.1. Grammatical Concepts"},{"refs":[{"id":"ref-for-appendix-B.1\u2461"},{"id":"ref-for-appendix-B.1\u2462"},{"id":"ref-for-appendix-B.1\u2463"},{"id":"ref-for-appendix-B.1\u2464"},{"id":"ref-for-appendix-B.1\u2465"}],"title":"3.5. The integrity attribute"}],"url":"https://tools.ietf.org/html/rfc5234#appendix-B.1"},
"cb98f71f": {"dfnID":"cb98f71f","dfnText":"mode","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-mode"}],"title":"3.8.2. Should request be blocked by Integrity Policy"}],"url":"https://fetch.spec.whatwg.org/#concept-request-mode"},
"d1364af2": {"dfnID":"d1364af2","dfnText":"link","external":true,"refSections":[{"refs":[{"id":"ref-for-link"}],"title":"3.6. The integrity link processing option"}],"url":"https://tools.ietf.org/html/rfc8288#link"},
"d5434eef": {"dfnID":"d5434eef","dfnText":"contains","external":true,"refSections":[{"refs":[{"id":"ref-for-header-list-contains"},{"id":"ref-for-header-list-contains\u2460"}],"title":"3.8.1. Parse Integrity-Policy headers"}],"url":"https://fetch.spec.whatwg.org/#header-list-contains"},
"d79a826f": {"dfnID":"d79a826f","dfnText":"integrity metadata","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-integrity-metadata"}],"title":"3.8.2. Should request be blocked by Integrity Policy"}],"url":"https://fetch.spec.whatwg.org/#concept-request-integrity-metadata"},
"d85a6c84": {"dfnID":"d85a6c84","dfnText":"header list","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-header-list"}],"title":"3.8. Integrity-Policy"}],"url":"https://fetch.spec.whatwg.org/#concept-header-list"},
"dc1cd39b": {"dfnID":"dc1cd39b","dfnText":"URL","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-url"}],"title":"3.8.2. Should request be blocked by Integrity Policy"},{"refs":[{"id":"ref-for-concept-request-url\u2460"}],"title":"3.8.3. Report violations"}],"url":"https://fetch.spec.whatwg.org/#concept-request-url"},
"dcffbccd": {"dfnID":"dcffbccd","dfnText":"URL","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url"}],"title":"3.8.3. Report violations"}],"url":"https://url.spec.whatwg.org/#concept-url"},
"destination": {"dfnID":"destination","dfnText":"destination","external":false,"refSections":[{"refs":[{"id":"ref-for-destination"}],"title":"3.8. Integrity-Policy"}],"url":"#destination"},
"dictdef-integrityviolationreportbody": {"dfnID":"dictdef-integrityviolationreportbody","dfnText":"IntegrityViolationReportBody","external":false,"refSections":[{"refs":[{"id":"ref-for-dictdef-integrityviolationreportbody"},{"id":"ref-for-dictdef-integrityviolationreportbody\u2460"}],"title":"3.8.3. Report violations"}],"url":"#dictdef-integrityviolationreportbody"},
"digest": {"dfnID":"digest","dfnText":"digest","external":false,"refSections":[{"refs":[{"id":"ref-for-digest"}],"title":"3.1. Integrity metadata"}],"url":"#digest"},
"does-response-match-metadatalist": {"dfnID":"does-response-match-metadatalist","dfnText":"3.3.4. Do bytes match metadataList?","external":false,"refSections":[{"refs":[{"id":"ref-for-does-response-match-metadatalist"}],"title":"3.2.1. Agility"},{"refs":[{"id":"ref-for-does-response-match-metadatalist"}],"title":"3.3.4. Do bytes match metadataList?"}],"url":"#does-response-match-metadatalist"},
"dom-integrityviolationreportbody-blockedurl": {"dfnID":"dom-integrityviolationreportbody-blockedurl","dfnText":"blockedURL","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-integrityviolationreportbody-blockedurl"},{"id":"ref-for-dom-integrityviolationreportbody-blockedurl\u2460"}],"title":"3.8.3. Report violations"}],"url":"#dom-integrityviolationreportbody-blockedurl"},
"dom-integrityviolationreportbody-destination": {"dfnID":"dom-integrityviolationreportbody-destination","dfnText":"destination","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-integrityviolationreportbody-destination"},{"id":"ref-for-dom-integrityviolationreportbody-destination\u2460"}],"title":"3.8.3. Report violations"}],"url":"#dom-integrityviolationreportbody-destination"},
"dom-integrityviolationreportbody-documenturl": {"dfnID":"dom-integrityviolationreportbody-documenturl","dfnText":"documentURL","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-integrityviolationreportbody-documenturl"},{"id":"ref-for-dom-integrityviolationreportbody-documenturl\u2460"}],"title":"3.8.3. Report violations"}],"url":"#dom-integrityviolationreportbody-documenturl"},
"dom-integrityviolationreportbody-reportonly": {"dfnID":"dom-integrityviolationreportbody-reportonly","dfnText":"reportOnly","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-integrityviolationreportbody-reportonly"},{"id":"ref-for-dom-integrityviolationreportbody-reportonly\u2460"}],"title":"3.8.3. Report violations"}],"url":"#dom-integrityviolationreportbody-reportonly"},
"e56c6177": {"dfnID":"e56c6177","dfnText":"destination type","external":true,"refSections":[{"refs":[{"id":"ref-for-destination-type"}],"title":"3.8. Integrity-Policy"}],"url":"https://fetch.spec.whatwg.org/#destination-type"},
"e5fc5b88": {"dfnID":"e5fc5b88","dfnText":"strictly split","external":true,"refSections":[{"refs":[{"id":"ref-for-strictly-split"},{"id":"ref-for-strictly-split\u2460"},{"id":"ref-for-strictly-split\u2461"}],"title":"3.3.2. Parse metadata"}],"url":"https://infra.spec.whatwg.org/#strictly-split"},
"ee7bba09": {"dfnID":"ee7bba09","dfnText":"response","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response"}],"title":"3.8.1. Parse Integrity-Policy headers"}],"url":"https://fetch.spec.whatwg.org/#concept-response"},
"endpoints": {"dfnID":"endpoints","dfnText":"endpoints","external":false,"refSections":[{"refs":[{"id":"ref-for-endpoints"}],"title":"3.8. Integrity-Policy"},{"refs":[{"id":"ref-for-endpoints\u2460"},{"id":"ref-for-endpoints\u2461"}],"title":"3.8.3. Report violations"}],"url":"#endpoints"},
"f4486aa1": {"dfnID":"f4486aa1","dfnText":"token","external":true,"refSections":[{"refs":[{"id":"ref-for-name-tokens"}],"title":"3.8. Integrity-Policy"}],"url":"https://tools.ietf.org/html/rfc9651#name-tokens"},
"f7b00a8b": {"dfnID":"f7b00a8b","dfnText":"header list (for response)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response-header-list"}],"title":"3.8.1. Parse Integrity-Policy headers"}],"url":"https://fetch.spec.whatwg.org/#concept-response-header-list"},
"f937b7b6": {"dfnID":"f937b7b6","dfnText":"continue","external":true,"refSections":[{"refs":[{"id":"ref-for-iteration-continue"}],"title":"3.3.2. Parse metadata"},{"refs":[{"id":"ref-for-iteration-continue\u2460"},{"id":"ref-for-iteration-continue\u2461"}],"title":"3.3.3. Get the strongest metadata from set"}],"url":"https://infra.spec.whatwg.org/#iteration-continue"},
"grammardef-hash-expression": {"dfnID":"grammardef-hash-expression","dfnText":"hash-expression","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-hash-expression"}],"title":"3.5. The integrity attribute"}],"url":"#grammardef-hash-expression"},
"grammardef-hash-with-options": {"dfnID":"grammardef-hash-with-options","dfnText":"hash-with-options","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-hash-with-options"},{"id":"ref-for-grammardef-hash-with-options\u2460"}],"title":"3.5. The integrity attribute"}],"url":"#grammardef-hash-with-options"},
"grammardef-integrity-metadata": {"dfnID":"grammardef-integrity-metadata","dfnText":"integrity-metadata","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-integrity-metadata"}],"title":"3.6. The integrity link processing option"}],"url":"#grammardef-integrity-metadata"},
"grammardef-option-expression": {"dfnID":"grammardef-option-expression","dfnText":"option-expression","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-option-expression"}],"title":"3.5. The integrity attribute"}],"url":"#grammardef-option-expression"},
"integrity-metadata": {"dfnID":"integrity-metadata","dfnText":"integrity\n  metadata","external":false,"refSections":[{"refs":[{"id":"ref-for-integrity-metadata"},{"id":"ref-for-integrity-metadata\u2460"},{"id":"ref-for-integrity-metadata\u2461"}],"title":"1.2.1. Resource Integrity"},{"refs":[{"id":"ref-for-integrity-metadata\u2462"}],"title":"3.2. Cryptographic hash functions"},{"refs":[{"id":"ref-for-integrity-metadata\u2463"}],"title":"3.2.1. Agility"},{"refs":[{"id":"ref-for-integrity-metadata\u2464"}],"title":"3.5. The integrity attribute"},{"refs":[{"id":"ref-for-integrity-metadata\u2465"}],"title":"3.6. The integrity link processing option"},{"refs":[{"id":"ref-for-integrity-metadata\u2466"}],"title":"4. Proxies"},{"refs":[{"id":"ref-for-integrity-metadata\u2467"}],"title":"5.1. Non-secure contexts remain non-secure"}],"url":"#integrity-metadata"},
"integrity-policy": {"dfnID":"integrity-policy","dfnText":"integrity policy","external":false,"refSections":[{"refs":[{"id":"ref-for-integrity-policy"}],"title":"3.8. Integrity-Policy"},{"refs":[{"id":"ref-for-integrity-policy\u2460"}],"title":"3.8.2. Should request be blocked by Integrity Policy"},{"refs":[{"id":"ref-for-integrity-policy\u2461"},{"id":"ref-for-integrity-policy\u2462"}],"title":"3.8.3. Report violations"}],"url":"#integrity-policy"},
"parse-integrity-policy-headers": {"dfnID":"parse-integrity-policy-headers","dfnText":"parse Integrity-Policy headers","external":false,"refSections":[],"url":"#parse-integrity-policy-headers"},
"parse-metadata": {"dfnID":"parse-metadata","dfnText":"parse metadata","external":false,"refSections":[{"refs":[{"id":"ref-for-parse-metadata"}],"title":"3.3.4. Do bytes match metadataList?"},{"refs":[{"id":"ref-for-parse-metadata\u2460"}],"title":"3.8.2. Should request be blocked by Integrity Policy"}],"url":"#parse-metadata"},
"processing-an-integrity-policy": {"dfnID":"processing-an-integrity-policy","dfnText":"processing an integrity policy","external":false,"refSections":[{"refs":[{"id":"ref-for-processing-an-integrity-policy"},{"id":"ref-for-processing-an-integrity-policy\u2460"}],"title":"3.8.1. Parse Integrity-Policy headers"}],"url":"#processing-an-integrity-policy"},
"report-violation": {"dfnID":"report-violation","dfnText":"report violation","external":false,"refSections":[{"refs":[{"id":"ref-for-report-violation"}],"title":"3.8.2. Should request be blocked by Integrity Policy"}],"url":"#report-violation"},
"should-request-be-blocked-by-integrity-policy": {"dfnID":"should-request-be-blocked-by-integrity-policy","dfnText":"should request be blocked by integrity policy","external":false,"refSections":[],"url":"#should-request-be-blocked-by-integrity-policy"},
"source": {"dfnID":"source","dfnText":"source","external":false,"refSections":[{"refs":[{"id":"ref-for-source"}],"title":"3.8. Integrity-Policy"}],"url":"#source"},
"sources": {"dfnID":"sources","dfnText":"sources","external":false,"refSections":[{"refs":[{"id":"ref-for-sources"}],"title":"3.8. Integrity-Policy"},{"refs":[{"id":"ref-for-sources\u2460"},{"id":"ref-for-sources\u2461"}],"title":"3.8.2. Should request be blocked by Integrity Policy"}],"url":"#sources"},
"valid-sri-hash-algorithm-token": {"dfnID":"valid-sri-hash-algorithm-token","dfnText":"valid SRI hash algorithm token","external":false,"refSections":[{"refs":[{"id":"ref-for-valid-sri-hash-algorithm-token"}],"title":"3.3.2. Parse metadata"},{"refs":[{"id":"ref-for-valid-sri-hash-algorithm-token\u2460"}],"title":"3.3.3. Get the strongest metadata from set"}],"url":"#valid-sri-hash-algorithm-token"},
"valid-sri-hash-algorithm-token-set": {"dfnID":"valid-sri-hash-algorithm-token-set","dfnText":"valid SRI hash algorithm token set","external":false,"refSections":[{"refs":[{"id":"ref-for-valid-sri-hash-algorithm-token-set"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-valid-sri-hash-algorithm-token-set\u2460"}],"title":"3.2.2. Priority"},{"refs":[{"id":"ref-for-valid-sri-hash-algorithm-token-set\u2461"},{"id":"ref-for-valid-sri-hash-algorithm-token-set\u2462"}],"title":"3.3.3. Get the strongest metadata from set"}],"url":"#valid-sri-hash-algorithm-token-set"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#base64-encoding": {"displayText":"base64 encoding","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"base64 encoding","type":"dfn","url":"#base64-encoding"},
"#blocked-destinations": {"displayText":"blocked destinations","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"blocked destinations","type":"dfn","url":"#blocked-destinations"},
"#destination": {"displayText":"destination","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"destination","type":"dfn","url":"#destination"},
"#dictdef-integrityviolationreportbody": {"displayText":"IntegrityViolationReportBody","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"IntegrityViolationReportBody","type":"dictionary","url":"#dictdef-integrityviolationreportbody"},
"#digest": {"displayText":"digest","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"digest","type":"dfn","url":"#digest"},
"#dom-integrityviolationreportbody-blockedurl": {"displayText":"blockedURL","export":true,"for_":["IntegrityViolationReportBody"],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"blockedURL","type":"dict-member","url":"#dom-integrityviolationreportbody-blockedurl"},
"#dom-integrityviolationreportbody-destination": {"displayText":"destination","export":true,"for_":["IntegrityViolationReportBody"],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"destination","type":"dict-member","url":"#dom-integrityviolationreportbody-destination"},
"#dom-integrityviolationreportbody-documenturl": {"displayText":"documentURL","export":true,"for_":["IntegrityViolationReportBody"],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"documentURL","type":"dict-member","url":"#dom-integrityviolationreportbody-documenturl"},
"#dom-integrityviolationreportbody-reportonly": {"displayText":"reportOnly","export":true,"for_":["IntegrityViolationReportBody"],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"reportOnly","type":"dict-member","url":"#dom-integrityviolationreportbody-reportonly"},
"#endpoints": {"displayText":"endpoints","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"endpoints","type":"dfn","url":"#endpoints"},
"#grammardef-hash-expression": {"displayText":"hash-expression","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"hash-expression","type":"grammar","url":"#grammardef-hash-expression"},
"#grammardef-hash-with-options": {"displayText":"hash-with-options","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"hash-with-options","type":"grammar","url":"#grammardef-hash-with-options"},
"#grammardef-integrity-metadata": {"displayText":"integrity-metadata","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"integrity-metadata","type":"grammar","url":"#grammardef-integrity-metadata"},
"#grammardef-option-expression": {"displayText":"option-expression","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"option-expression","type":"grammar","url":"#grammardef-option-expression"},
"#integrity-metadata": {"displayText":"integrity metadata","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"integrity metadata","type":"dfn","url":"#integrity-metadata"},
"#integrity-policy": {"displayText":"integrity policy","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"integrity policy","type":"dfn","url":"#integrity-policy"},
"#parse-metadata": {"displayText":"parse metadata","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"parse metadata","type":"dfn","url":"#parse-metadata"},
"#processing-an-integrity-policy": {"displayText":"processing an integrity policy","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"processing an integrity policy","type":"dfn","url":"#processing-an-integrity-policy"},
"#report-violation": {"displayText":"report violation","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"report violation","type":"dfn","url":"#report-violation"},
"#source": {"displayText":"source","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"source","type":"dfn","url":"#source"},
"#sources": {"displayText":"sources","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"sources","type":"dfn","url":"#sources"},
"#valid-sri-hash-algorithm-token": {"displayText":"valid sri hash algorithm token","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"valid sri hash algorithm token","type":"dfn","url":"#valid-sri-hash-algorithm-token"},
"#valid-sri-hash-algorithm-token-set": {"displayText":"valid sri hash algorithm token set","export":true,"for_":[],"level":"2","normative":true,"shortname":"sri","spec":"sri-2","status":"local","text":"valid sri hash algorithm token set","type":"dfn","url":"#valid-sri-hash-algorithm-token-set"},
"14c46ca8_https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#": {"displayText":"SHA-2","export":true,"for_":[],"level":"","normative":true,"shortname":"sha2","spec":"sha2","status":"anchor-block","text":"sha-2","type":"dfn","url":"https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#"},
"37de769a_https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#": {"displayText":"SHA-384","export":true,"for_":[],"level":"","normative":true,"shortname":"sha2","spec":"sha2","status":"anchor-block","text":"sha-384","type":"dfn","url":"https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#"},
"3fed24ef_https://tools.ietf.org/html/rfc5234#appendix-B.1": {"displayText":"VCHAR","export":true,"for_":[],"level":"","normative":true,"shortname":"abnf","spec":"abnf","status":"anchor-block","text":"vchar","type":"grammar","url":"https://tools.ietf.org/html/rfc5234#appendix-B.1"},
"a801f883_https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#": {"displayText":"SHA-512","export":true,"for_":[],"level":"","normative":true,"shortname":"sha2","spec":"sha2","status":"anchor-block","text":"sha-512","type":"dfn","url":"https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#"},
"fc7b3d90_https://tools.ietf.org/html/rfc5234#appendix-B.1": {"displayText":"WSP","export":true,"for_":[],"level":"","normative":true,"shortname":"abnf","spec":"abnf","status":"anchor-block","text":"wsp","type":"dfn","url":"https://tools.ietf.org/html/rfc5234#appendix-B.1"},
"https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#": {"displayText":"SHA-256","export":true,"for_":[],"level":"","normative":true,"shortname":"sha2","spec":"sha2","status":"anchor-block","text":"sha-256","type":"dfn","url":"https://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#"},
"https://dom.spec.whatwg.org/#dom-document-url": {"displayText":"URL","export":true,"for_":["Document"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"URL","type":"attribute","url":"https://dom.spec.whatwg.org/#dom-document-url"},
"https://fetch.spec.whatwg.org/#concept-header-list": {"displayText":"header list","export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"header list","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-header-list"},
"https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header": {"displayText":"get a structured field value","export":true,"for_":["header list"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"get a structured field value","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header"},
"https://fetch.spec.whatwg.org/#concept-request": {"displayText":"request","export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"request","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request"},
"https://fetch.spec.whatwg.org/#concept-request-client": {"displayText":"client","export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"client","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-client"},
"https://fetch.spec.whatwg.org/#concept-request-destination": {"displayText":"destination","export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"destination","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-destination"},
"https://fetch.spec.whatwg.org/#concept-request-integrity-metadata": {"displayText":"integrity metadata","export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"integrity metadata","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-integrity-metadata"},
"https://fetch.spec.whatwg.org/#concept-request-mode": {"displayText":"mode","export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"mode","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-mode"},
"https://fetch.spec.whatwg.org/#concept-request-policy-container": {"displayText":"policy container","export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"policy container","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-policy-container"},
"https://fetch.spec.whatwg.org/#concept-request-url": {"displayText":"URL","export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"url","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-url"},
"https://fetch.spec.whatwg.org/#concept-response": {"displayText":"response","export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"response","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-response"},
"https://fetch.spec.whatwg.org/#concept-response-header-list": {"displayText":"header list","export":true,"for_":["response"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"header list","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-response-header-list"},
"https://fetch.spec.whatwg.org/#cors-protocol": {"displayText":"CORS protocol","export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"cors protocol","type":"dfn","url":"https://fetch.spec.whatwg.org/#cors-protocol"},
"https://fetch.spec.whatwg.org/#destination-type": {"displayText":"destination type","export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"destination type","type":"dfn","url":"https://fetch.spec.whatwg.org/#destination-type"},
"https://fetch.spec.whatwg.org/#header-list-contains": {"displayText":"contains","export":true,"for_":["header list"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"contains","type":"dfn","url":"https://fetch.spec.whatwg.org/#header-list-contains"},
"https://fetch.spec.whatwg.org/#header-name": {"displayText":"header name","export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"header name","type":"dfn","url":"https://fetch.spec.whatwg.org/#header-name"},
"https://fetch.spec.whatwg.org/#header-value": {"displayText":"header value","export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"header value","type":"dfn","url":"https://fetch.spec.whatwg.org/#header-value"},
"https://fetch.spec.whatwg.org/#is-local": {"displayText":"is local","export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"is local","type":"dfn","url":"https://fetch.spec.whatwg.org/#is-local"},
"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin": {"displayText":"origin","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"origin","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin"},
"https://html.spec.whatwg.org/multipage/browsers.html#policy-container": {"displayText":"policy container","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"policy container","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#policy-container"},
"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-integrity-policy": {"displayText":"integrity policy","export":true,"for_":["policy container"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"integrity policy","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-integrity-policy"},
"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-report-only-integrity-policy": {"displayText":"report only integrity policy","export":true,"for_":["policy container"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"report only integrity policy","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-report-only-integrity-policy"},
"https://html.spec.whatwg.org/multipage/browsers.html#same-origin": {"displayText":"same origin","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"same origin","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#same-origin"},
"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window": {"displayText":"associated Document","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"associated document","type":"dfn","url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window"},
"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window": {"displayText":"Window","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"Window","type":"interface","url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window"},
"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global": {"displayText":"global object","export":true,"for_":["environment settings object"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"global object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"},
"https://html.spec.whatwg.org/multipage/webappapis.html#secure-context": {"displayText":"secure context","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"secure context","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#secure-context"},
"https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-url": {"displayText":"url","export":true,"for_":["WorkerGlobalScope"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"url","type":"dfn","url":"https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-url"},
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope": {"displayText":"WorkerGlobalScope","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"WorkerGlobalScope","type":"interface","url":"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope"},
"https://infra.spec.whatwg.org/#ascii-lowercase": {"displayText":"ASCII lowercase","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"ascii lowercase","type":"dfn","url":"https://infra.spec.whatwg.org/#ascii-lowercase"},
"https://infra.spec.whatwg.org/#assert": {"displayText":"assert","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"assert","type":"dfn","url":"https://infra.spec.whatwg.org/#assert"},
"https://infra.spec.whatwg.org/#iteration-continue": {"displayText":"continue","export":true,"for_":["iteration"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"continue","type":"dfn","url":"https://infra.spec.whatwg.org/#iteration-continue"},
"https://infra.spec.whatwg.org/#list": {"displayText":"list","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"list","type":"dfn","url":"https://infra.spec.whatwg.org/#list"},
"https://infra.spec.whatwg.org/#list-append": {"displayText":"append","export":true,"for_":["list"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"append","type":"dfn","url":"https://infra.spec.whatwg.org/#list-append"},
"https://infra.spec.whatwg.org/#list-contain": {"displayText":"contain","export":true,"for_":["list","stack","queue","set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"contain","type":"dfn","url":"https://infra.spec.whatwg.org/#list-contain"},
"https://infra.spec.whatwg.org/#list-is-empty": {"displayText":"is empty","export":true,"for_":["list","stack","queue","set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"is empty","type":"dfn","url":"https://infra.spec.whatwg.org/#list-is-empty"},
"https://infra.spec.whatwg.org/#list-iterate": {"displayText":"for each","export":true,"for_":["list","set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"for each","type":"dfn","url":"https://infra.spec.whatwg.org/#list-iterate"},
"https://infra.spec.whatwg.org/#map-exists": {"displayText":"exist","export":true,"for_":["map"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"exist","type":"dfn","url":"https://infra.spec.whatwg.org/#map-exists"},
"https://infra.spec.whatwg.org/#ordered-set": {"displayText":"ordered set","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"ordered set","type":"dfn","url":"https://infra.spec.whatwg.org/#ordered-set"},
"https://infra.spec.whatwg.org/#set-append": {"displayText":"append","export":true,"for_":["set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"append","type":"dfn","url":"https://infra.spec.whatwg.org/#set-append"},
"https://infra.spec.whatwg.org/#strictly-split": {"displayText":"strictly split","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"strictly split","type":"dfn","url":"https://infra.spec.whatwg.org/#strictly-split"},
"https://infra.spec.whatwg.org/#struct": {"displayText":"struct","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"struct","type":"dfn","url":"https://infra.spec.whatwg.org/#struct"},
"https://tools.ietf.org/html/rfc5234#appendix-B.1": {"displayText":"VCHAR","export":true,"for_":[],"level":"","normative":true,"shortname":"abnf","spec":"abnf","status":"anchor-block","text":"vchar","type":"dfn","url":"https://tools.ietf.org/html/rfc5234#appendix-B.1"},
"https://tools.ietf.org/html/rfc7234#section-5.2": {"displayText":"Cache-Control","export":true,"for_":[],"level":"","normative":true,"shortname":"rfc7234","spec":"rfc7234","status":"anchor-block","text":"cache-control","type":"dfn","url":"https://tools.ietf.org/html/rfc7234#section-5.2"},
"https://tools.ietf.org/html/rfc7234#section-5.2.1.6": {"displayText":"no-transform","export":true,"for_":[],"level":"","normative":true,"shortname":"rfc7234","spec":"rfc7234","status":"anchor-block","text":"no-transform","type":"dfn","url":"https://tools.ietf.org/html/rfc7234#section-5.2.1.6"},
"https://tools.ietf.org/html/rfc8288#link": {"displayText":"link","export":true,"for_":[],"level":"","normative":true,"shortname":"rfc8288","spec":"rfc8288","status":"anchor-block","text":"link","type":"http-header","url":"https://tools.ietf.org/html/rfc8288#link"},
"https://tools.ietf.org/html/rfc9651#name-dictionaries": {"displayText":"Dictionary","export":true,"for_":[],"level":"","normative":true,"shortname":"rfc9651","spec":"rfc9651","status":"anchor-block","text":"dictionary","type":"dfn","url":"https://tools.ietf.org/html/rfc9651#name-dictionaries"},
"https://tools.ietf.org/html/rfc9651#name-inner-lists": {"displayText":"inner list","export":true,"for_":[],"level":"","normative":true,"shortname":"rfc9651","spec":"rfc9651","status":"anchor-block","text":"inner list","type":"dfn","url":"https://tools.ietf.org/html/rfc9651#name-inner-lists"},
"https://tools.ietf.org/html/rfc9651#name-tokens": {"displayText":"token","export":true,"for_":[],"level":"","normative":true,"shortname":"rfc9651","spec":"rfc9651","status":"anchor-block","text":"token","type":"dfn","url":"https://tools.ietf.org/html/rfc9651#name-tokens"},
"https://url.spec.whatwg.org/#concept-url": {"displayText":"URL","export":true,"for_":[],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"url","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url"},
"https://w3c.github.io/reporting/#generate-and-queue-a-report": {"displayText":"generate and queue a report","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"current","text":"generate and queue a report","type":"dfn","url":"https://w3c.github.io/reporting/#generate-and-queue-a-report"},
"https://w3c.github.io/reporting/#generate-and-queue-a-report-context": {"displayText":"context","export":true,"for_":["generate and queue a report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"current","text":"context","type":"dfn","url":"https://w3c.github.io/reporting/#generate-and-queue-a-report-context"},
"https://w3c.github.io/reporting/#generate-and-queue-a-report-data": {"displayText":"data","export":true,"for_":["generate and queue a report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"current","text":"data","type":"dfn","url":"https://w3c.github.io/reporting/#generate-and-queue-a-report-data"},
"https://w3c.github.io/reporting/#generate-and-queue-a-report-destination": {"displayText":"destination","export":true,"for_":["generate and queue a report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"current","text":"destination","type":"dfn","url":"https://w3c.github.io/reporting/#generate-and-queue-a-report-destination"},
"https://w3c.github.io/reporting/#generate-and-queue-a-report-type": {"displayText":"type","export":true,"for_":["generate and queue a report"],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"current","text":"type","type":"dfn","url":"https://w3c.github.io/reporting/#generate-and-queue-a-report-type"},
"https://w3c.github.io/reporting/#reportbody": {"displayText":"ReportBody","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"current","text":"ReportBody","type":"dictionary","url":"https://w3c.github.io/reporting/#reportbody"},
"https://w3c.github.io/reporting/#strip-url-for-use-in-reports": {"displayText":"strip URL for use in reports","export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"current","text":"strip url for use in reports","type":"dfn","url":"https://w3c.github.io/reporting/#strip-url-for-use-in-reports"},
"https://w3c.github.io/webappsec-csp/#grammardef-base64-value": {"displayText":"base64-value","export":true,"for_":[],"level":"3","normative":true,"shortname":"csp","spec":"csp3","status":"current","text":"base64-value","type":"grammar","url":"https://w3c.github.io/webappsec-csp/#grammardef-base64-value"},
"https://w3c.github.io/webappsec-csp/#grammardef-hash-algorithm": {"displayText":"hash-algorithm","export":true,"for_":[],"level":"3","normative":true,"shortname":"csp","spec":"csp3","status":"current","text":"hash-algorithm","type":"grammar","url":"https://w3c.github.io/webappsec-csp/#grammardef-hash-algorithm"},
"https://webidl.spec.whatwg.org/#idl-USVString": {"displayText":"USVString","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"USVString","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-USVString"},
"https://webidl.spec.whatwg.org/#idl-boolean": {"displayText":"boolean","export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"boolean","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-boolean"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
        // Give the original term if it's being displayed in a different way.
        // But allow casing differences, they're insignificant.
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.displayText)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const refHintKey = link.getAttribute("data-refhint-key");
    let key = url;
    if(refHintKey) {
        key = refHintKey + "_" + url;
    }
    const ref = refsData[key];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>
<script>/* Boilerplate: script-wpt */
"use strict";
{
let wptData = {
"paths": ["/subresource-integrity/"],
};

document.addEventListener("DOMContentLoaded", async ()=>{
    if(wptData.paths.length == 0) return;

    const runsUrl = "https://wpt.fyi/api/runs?label=master&label=stable&max-count=1&product=chrome&product=firefox&product=safari&product=edge";
    const runs = await (await fetch(runsUrl)).json();

    let testResults = [];
    for(const pathPrefix of wptData.paths) {
        const pathResults = await (await fetch("https://wpt.fyi/api/search", {
            method:"POST",
            headers:{
                "Content-Type":"application/json",
            },
            body: JSON.stringify({
                "run_ids": runs.map(x=>x.id),
                "query": {"path": pathPrefix},
            })
        })).json();
        testResults = testResults.concat(pathResults.results);
    }

    const browsers = runs.map(x=>({name:x.browser_name, version:x.browser_version, passes:0, total: 0}));
    const resultsFromPath = new Map(testResults.map(result=>{
        const testPath = result.test;
        const passes = result.legacy_status.map(x=>[x.passes, x.total]);
        return [testPath, passes];
    }));
    const seenTests = new Set();
    document.querySelectorAll(".wpt-name").forEach(nameEl=>{
        const passData = resultsFromPath.get("/" + nameEl.getAttribute("title"));
        if(!passData) {
            console.log("Couldn't find test in results:", nameEl);
            return
        }
        const numTests = passData[0][1];
        if(numTests > 1) {
            nameEl.insertAdjacentElement("beforeend",
                mk.small({}, ` (${numTests} tests)`));
        }
        if(passData == undefined) return;
        const resultsEl = mk.span({"class":"wpt-results"},
            ...passData.map((p,i) => mk.span(
            {
                "title": `${browsers[i].name} ${p[0]}/${p[1]}`,
                "class": "wpt-result",
                "style": `background: conic-gradient(forestgreen ${p[0]/p[1]*360}deg, darkred 0deg);`,
            })),
        );
        nameEl.insertAdjacentElement("afterend", resultsEl);

        // Only update the summary pass/total count if we haven't seen this
        // test before, to support authors listing the same test multiple times
        // in a spec.
        if (!seenTests.has(nameEl.getAttribute("title"))) {
            seenTests.add(nameEl.getAttribute("title"));
            passData.forEach((p,i) => {
                browsers[i].passes += p[0];
                browsers[i].total += p[1];
            });
        }
    });
    const overview = document.querySelector(".wpt-overview");
    if(overview) {
        overview.appendChild(mk.ul({}, ...browsers.map(formatWptResult)));
        document.head.appendChild(mk.style({},
            `.wpt-overview ul { display: flex; flex-flow: row wrap; gap: .2em; justify-content: start; list-style: none; padding: 0; margin: 0;}
             .wpt-overview li { padding: .25em 1em; color: black; text-align: center; }
             .wpt-overview img { height: 1.5em; height: max(1.5em, 32px); background: transparent; }
             .wpt-overview .browser { font-weight: bold; }
             .wpt-overview .passes-none { background: #e57373; }
             .wpt-overview .passes-hardly { background: #ffb74d; }
             .wpt-overview .passes-a-few { background: #ffd54f; }
             .wpt-overview .passes-half { background: #fff176; }
             .wpt-overview .passes-lots { background: #dce775; }
             .wpt-overview .passes-most { background: #aed581; }
             .wpt-overview .passes-all { background: #81c784; }`));
    }
});

function formatWptResult({name, version, passes, total}) {
    const passRate = passes/total;
    let passClass = "";
    if(passRate == 0)      passClass = "passes-none";
    else if(passRate < .2) passClass = "passes-hardly";
    else if(passRate < .4) passClass = "passes-a-few";
    else if(passRate < .6) passClass = "passes-half";
    else if(passRate < .8) passClass = "passes-lots";
    else if(passRate < 1)  passClass = "passes-most";
    else                   passClass = "passes-all";

    name = name[0].toUpperCase() + name.slice(1);
    const shortVersion = /^\d+/.exec(version);
    const icon = []

    if(name == "Chrome") icon.push(mk.img({alt:"", src:"https://wpt.fyi/static/chrome_64x64.png"}));
    if(name == "Edge") icon.push(mk.img({alt:"", src:"https://wpt.fyi/static/edge_64x64.png"}));
    if(name == "Safari") icon.push(mk.img({alt:"", src:"https://wpt.fyi/static/safari_64x64.png"}));
    if(name == "Firefox") icon.push(mk.img({alt:"", src:"https://wpt.fyi/static/firefox_64x64.png"}));

    return mk.li({"class":passClass},
        mk.nobr({'class':'browser'}, ...icon, ` ${name} ${shortVersion}`),
        mk.br(),
        mk.nobr({'class':'pass-rate'}, `${passes}/${total}`)
    );
}
}
</script>